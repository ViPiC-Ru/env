/* 0.1.3 определяет дополнительные переменные среды

cscript env.min.js [<context>] [<action>] ...

<context>   - в контексте какого компьютера получить переменные
<action>    - действие которое нужно выполнить
    silent  - последующие команды выполнить без отображения
    print   - вывести дополнительные переменные в консоль
    csv     - вывести дополнительные переменные в формате csv

*/

// 0.3.15 конструктор основного приложения
function App(a){this.val=a};

// 0.1.5 библиотека функций общего назначения
(function(r,D){r.lib={strFirstUpperCase:function(a){return a.substr(0,1).toUpperCase()+a.substr(1)},clone:function(a){switch(!0){case r.lib.validate(a,"date"):var b=new Date(a);break;case r.lib.validate(a,"array"):b=[];for(var c=0,e=a.length;c<e;c++)b[c]=r.lib.clone(a[c]);break;case r.lib.validate(a,"object"):b={};for(c in a)b[c]="prototype"!==c?r.lib.clone(a[c]):a[c];break;default:b=a}return b},compare:function(a,b,c){var e=0;b||(b=null);switch(!0){case r.lib.validate(a,"string"):b=r.lib.convert(b,
"string");c&&(a=a.toLowerCase(),b=b.toLowerCase());break;case r.lib.validate(a,"array"):b=b&&b.length?b.length:0;a=a.length;break;case r.lib.validate(a,"date"):b=b&&b.valueOf()?b.valueOf():0,a=a.valueOf()}a>b&&(e=1);a<b&&(e=-1);return e},difference:function(a,b,c){var e;c||(c=r.lib.compare);if(r.lib.validate(a,"array")){b||(b=[]);for(var d=0,k=a.length;d<k;d++){var n=a[d];for(var f=0,g=b.length;f<g;f++){var m=b[f];if(value=c(n,m))e||(e=[]),e.push(n)}}}else if(r.lib.validate(a,"object"))for(d in b||
(b={}),a)n=a[d],m=b[d],value=r.lib.difference(n,m,c),r.lib.validate(value,"undefined")||(e||(e={}),e[d]=value);else(value=r.lib.compare(a,b))&&(e=a);return e},strim:function(a,b,c,e,d){var k="";a=a?a.toString():k;b=b?b.toString():k;c=c?c.toString():k;if(d){var n=c?a.lastIndexOf(c):a.length;d=b&&~n?a.lastIndexOf(b,n-1):0}else d=b?a.indexOf(b):0,n=c&&~d?a.indexOf(c,d+b.length):a.length;~d&&~n&&(d=e?d:d+b.length,n=e?n+c.length:n,k=a.substr(d,n-d));return k},trim:function(a){return(a||"").replace(/^\s+|\s+$/g,
"")},validate:function(a,b){var c;switch(b){case "email":b="^([a-z0-9_-]+.)*[a-z0-9_-]+@[a-z0-9_-]+(.[a-z0-9_-]+)*.[a-z]{2,6}$";break;case "password":b="(?=^.{8,}$)((?=.*d)|(?=.*W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$";break;case "guid":b="^{[0-9a-fA-F]{8}(-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}}$";break;case "md5":b="^[0-9a-fA-F]{32}$"}switch(b){case "string":a="[object String]"===Object.prototype.toString.call(a);break;case "number":a="[object Number]"===Object.prototype.toString.call(a);break;case "boolean":a=
"[object Boolean]"===Object.prototype.toString.call(a);break;case "function":a="[object Function]"===Object.prototype.toString.call(a);break;case "form":a=!(!a||!a.tagName||"form"!==a.tagName.toLowerCase());break;case "files":a="[object FileList]"===Object.prototype.toString.call(a);break;case "date":a="[object Date]"===Object.prototype.toString.call(a);break;case "array":a=Array.isArray?Array.isArray(a):"[object Array]"===Object.prototype.toString.call(a);break;case "xml":a=!(!a||!(c=(a.ownerDocument||
a).documentElement)||"html"===c.nodeName.toLowerCase());break;case "undefined":a=void 0===a;break;case "null":a=null===a;break;case "object":a=a===Object(a)&&"[object Null]"!==Object.prototype.toString.call(a)&&"[object Date]"!==Object.prototype.toString.call(a)&&"[object Function]"!==Object.prototype.toString.call(a)&&"[object FileList]"!==Object.prototype.toString.call(a)&&"[object Array]"!==Object.prototype.toString.call(a)&&!(a&&(c=(a.ownerDocument||a).documentElement)&&"html"!==c.nodeName.toLowerCase())&&
!(a&&a.tagName&&"form"===a.tagName.toLowerCase());break;default:a=(new RegExp(b)).test(""+a)}return a},obj2str:function(a,b,c,e,d){var k=[];c||(c="&");e||(e="=");d||(d=",");for(var n in a){var f=a[n];var g=b?encodeURIComponent(n):n;switch(!0){case r.lib.validate(f,"array"):f=f.join(d);case !r.lib.validate(f,"undefined"):g+=e,g+=b?encodeURIComponent(f):f}k.push(g)}return k.join(c)},str2obj:function(a,b,c,e){var d,k={};c||(c="&");e||(e="=");c=a.split(c);for(var n=0,f=c.length;n<f;n++)if(d=c[n])d=d.split(e,
2),a=d[0],d=d[1],a=b?decodeURIComponent(a):a,d=b&&d?decodeURIComponent(d):d,k[a]=d;return k},url2obj:function(a){var b=a,c={},e=!1;a="fragment";var d="#";-1!=b.indexOf(d)&&(c[a]=r.lib.strim(b,d,null,!1),b=r.lib.strim(b,null,d,!1));a="query";d="?";-1!=b.indexOf(d)&&(c[a]=r.lib.strim(b,d,null,!1),b=r.lib.strim(b,null,d,!1));a="scheme";d="//";0==b.indexOf(d)&&(c[a]=r.lib.strim(b,null,d,!1),b=r.lib.strim(b,d,null,!1),e=!0);a="path";d="/";b.indexOf("://")>b.indexOf(d)&&(c[a]=r.lib.strim(b,d,null,!0),b=
r.lib.strim(b,null,d,!1));a="path";d="://";0==b.indexOf(d)&&(c[a]=r.lib.strim(b,d,null,!0),b=r.lib.strim(b,null,d,!1));a="scheme";d="://";!e&&0<b.indexOf(d)&&(c[a]=r.lib.strim(b,null,d,!1),b=r.lib.strim(b,d,null,!1),e=!0);a="path";d="/";e&&-1!=b.indexOf(d)&&(c[a]=r.lib.strim(b,d,null,!0),b=r.lib.strim(b,null,d,!1));a="path";d=b.length;!e&&0<d&&(c[a]=b,b="");d="@";if(-1!=b.indexOf(d)){var k=r.lib.strim(b,d,null,!1);b=r.lib.strim(b,null,d,!1);a="password";d=":";-1!=b.indexOf(d)&&(c[a]=r.lib.strim(b,
d,null,!1),b=r.lib.strim(b,null,d,!1));c.user=b;b=k}a="port";d=":";-1!=b.indexOf(d)&&(c[a]=r.lib.strim(b,d,null,!1),b=r.lib.strim(b,null,d,!1));e&&(c.domain=b);return c},obj2url:function(a){var b="";"user"in a&&(b="//");"password"in a&&(b="//");"domain"in a&&(b="//");"port"in a&&(b="//");var c="scheme";a[c]&&(b="://");var e=""+((a[c]?a[c]:"")+b);c="user";c in a&&(e+=""+a[c]);c="password";c in a&&(e+=":"+a[c]);b="";"user"in a&&(b="@");"password"in a&&(b="@");c="domain";e+=b+(a[c]?a[c]:"");c="port";
c in a&&(e+=":"+a[c]);c="path";c in a&&(e+=""+a[c]);c="query";c in a&&(e+="?"+a[c]);c="fragment";c in a&&(e+="#"+a[c]);return e},data2obj:function(a){var b={};a=a.split("\r\n");var c=a.shift().split("\t");for(var e=0;e<c.length;e++)c[e]=c[e].split(":"),c[e]={name:c[e][0],type:c[e][1]};e=0;for(var d=a.length;e<d;e++){var k=a[e].split("\t",c.length);var n={};for(var f=0;f<k.length;f++)n[c[f].name]=r.lib.convert(k[f],c[f].type);c[0]&&(b[n[c[0].name]]=n)}return b},obj2data:function(a){var b=[],c=[];split=
"\t";delim="\r\n";param=":";none=" ";for(var e in a){if(!b.length){var d=[];for(g in a[e]){var k=a[e][g];k="id"==g?"integer":r.lib.validate(k,"number")?"float":r.lib.validate(k,"boolean")?"boolean":r.lib.validate(k,"date")?"date":"string";b["id"==g?0:b.length]={name:g,type:k};d[d.length]=g+param+k}c[c.length]=d.join(split)}d=[];for(var n=0,f=b.length;n<f;n++){var g=b[n].name;k=a[e][g];for(k=r.lib.convert(k,"string");-1!=k.indexOf(split);)k=k.replace(split,none);for(;-1!=k.indexOf(delim);)k=k.replace(delim,
none);k=k.replace(/[\t\r\n]/g,none);d[d.length]=k}c[c.length]=d.join(split)}return c.join(delim)},obj2arr:function(a,b){var c=[];b||(b=function(k){return k});for(var e in a){var d=a[e];d=b(d,e,a);r.lib.validate(d,"undefined")||c.push(d)}return c},arr2obj:function(a,b,c){var e={};b||(b=function(g){return g});c||(c=function(g,m){return m});for(var d=0,k=a.length;d<k;d++){var n=a[d];var f=c(n,d,a);n=b(n,d,a);r.lib.validate(n,"undefined")||r.lib.validate(f,"undefined")||(e[f]=n)}return e},convert:function(a,
b){switch(b){case "bool":case "boolean":a="true"===a?!0:"false"===a?!1:!!a;break;case "int":case "integer":case "float":case "double":case "real":case "number":a=Number(a);break;case "date":a=new Date(1E3*Number(a));break;case "string":r.lib.validate(a,"boolean")?a=a?"true":"false":r.lib.validate(a,"date")?(a=a.valueOf()/1E3,a=a.toString()):a=r.lib.validate(a,"number")?a.toString():a&&a.toString?a.toString():""}return a},xhr:function(a,b,c,e,d,k,n,f){var g,m=6E5,p=0;var h=g={responseText:""};var z=
null;if(!p){var q=a?""+a:"get";a=q.toUpperCase();switch(a.toLowerCase()){case "get":z=!0;break;case "head":z=!0;break;case "delete":z=!0}}if(!p){var u=function(){};var v={upload:u,download:u,success:u,error:u,complete:u};if(r.lib.validate(k,"function"))v.complete=k;else if(k)for(t in v)u=k[t],r.lib.validate(u,"function")&&(v[t]=u);k=v}if(!p){v={"X-Requested-With":"XMLHttpRequest"};if(!1===c){var t="X-Requested-With";t in v&&delete v[t]}if(r.lib.validate(c,"object"))for(t in c)switch(u=c[t],t.toLowerCase()){case "cookie":break;
case "host":break;default:v[t]=u}c=v}if(!p){e=e?e:"";if(r.lib.validate(e,"form")){v={};for(var w=0,x=e.elements.length;w<x;w++)u=e.elements[w],u.name&&!u.disabled&&(t=(""+u.type).toLowerCase(),"checkbox"==t||"radio"==t?u.checked&&(v[u.name]=u.value?u.value:!0):v[u.name]=u.files&&u.files.length?u.files:u.value?u.value:D);e=v}r.lib.validate(e,"xml")&&(z=!1,c["Content-Type"]="application/xml",e.xml?e=e.xml:(v=new XMLSerializer,e=v.serializeToString(e)));if(r.lib.validate(e,"object")){v=!1;for(t in e)if(u=
e[t],r.lib.validate(u,"files")){z=!1;v=!0;break}if(v)for(t in v=new FormData,e)if(u=e[t],r.lib.validate(u,"files")){var y=e[t];w=0;for(x=y.length;w<x;w++)u=y[w],v.append(t,u)}else r.lib.validate(u,"undefined")&&(u=""),v.append(t,u);else e=r.lib.obj2str(e,!0),!z&&e&&(c["Content-Type"]="application/x-www-form-urlencoded")}}p||(q=b?""+b:"",z&&e&&(q=q?~q.indexOf("?")?q+"&":q+"?":q+"?",q+=e,e=""),b=q);if(!p){v=null;if(!v)try{v=new XMLHttpRequest}catch(A){}if(!v)for(z="$#!&%",y=["Ms$#!&%xm$#!&%l2$#!&%.XM$#!&%LHT$#!&%TP.6.0",
"Ms$#!&%xm$#!&%l2$#!&%.XM$#!&%LHT$#!&%TP.3.0","Ms$#!&%xm$#!&%l2$#!&%.XM$#!&%LHT$#!&%TP","Micr$#!&%osoft$#!&%.XM$#!&%LH$#!&%TTP"],w=0,x=y.length;!v&&w<x;w++){u=y[w];q=u.split(z).join("");try{v=new ActiveXObject(q)}catch(A){}}v?h=v:p=1}if(!p){try{m=setTimeout(function(){q=h.responseText?h.responseText:"";h.abort();k.error(q,h);k.complete(q,h)},m)}catch(A){}h.upload&&(h.upload.onprogress=function(A){A.total&&A.loaded!=A.total&&k.upload(A,h)},h.onprogress=function(A){A.total&&A.loaded!=A.total&&k.download(A,
h)});h.onreadystatechange=function(A){if(4==h.readyState){try{clearTimeout(m)}catch(B){}t=h.status?h.status:200;q=h.responseText?h.responseText:"";200<=t&&300>t&&q?k.success(q,h):k.error(q,h);k.complete(q,h)}}}if(!p)try{f?h.open(a,b,d,n,f):n?h.open(a,b,d,n):h.open(a,b,d)}catch(A){h=g,p=2}if(!p)for(t in c)q=c[t],z="; ",r.lib.validate(q,"array")&&(y=q,q=y.join(z)),h.setRequestHeader(t,q);if(!p)try{e?h.send(e):h.send()}catch(A){h=g,p=3}if(1<p)try{clearTimeout(m)}catch(A){}p&&(q="",k.error(q,h),k.complete(q,
h));return h},ajax:function(a,b,c,e,d){return r.lib.xhr(a,b,c,e,!0,d)},sjax:function(a,b,c,e){return r.lib.xhr(a,b,c,e,!1)},strPad:function(a,b,c,e){var d,k=d="",n=function(f,g){for(;k.length<g;)k+=f;return k=k.substr(0,g)};a=""+a;c=c?""+c:" ";"left"!=e&&"right"!=e&&"both"!=e&&(e="right");0<(d=b-a.length)&&("left"==e?a=n(c,d)+a:"right"==e?a+=n(c,d):"both"==e&&(d=n(c,Math.ceil(d/2)),a=(d+a+a).substr(0,b)));return a},getCookie:function(a,b){var c=document.cookie.indexOf(a+"="),e=c+a.length+1;if(!c&&
a!=document.cookie.substring(0,a.length)||-1==c)return null;a=document.cookie.indexOf(";",e);-1==a&&(a=document.cookie.length);return b?decodeURIComponent(document.cookie.substring(e,a)):unescape(document.cookie.substring(e,a))},setCookie:function(a,b,c,e,d,k,n){var f=new Date((new Date).valueOf()+c);document.cookie=a+"="+(n?encodeURIComponent(b):escape(b))+(c?";expires="+f.toGMTString():"")+(e?";path="+e:"")+(d?";domain="+d:"")+(k?";secure":"");return!0},delCookie:function(a,b,c){r.lib.getCookie(a)&&
(document.cookie=a+"="+(b?";path="+b:"")+(c?";domain="+c:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT");return!0},getStorage:function(a,b){var c,e=null,d=null;if(c=window&&window.localStorage?localStorage.getItem(a):r.lib.getCookie(a)){var k=c.indexOf("?");-1!=k&&(type=c.substr(0,k),c=c.substr(k+1));b?(c=c.split("&"),!0!==b&&(c.length=Math.min(b,c.length))):c=[c];for(var n=0,f=c.length;n<f;n++){k=c[n].indexOf("=");if(-1!=k){if(a=c[n].substr(0,k),a=decodeURIComponent(a),e=c[n].substr(k+1),!d){var g=
!0;d={}}}else a=n,e=c[n],d||(g=!1,d=[]);e=decodeURIComponent(e);type&&(e=r.lib.convert(e,type));g?d[a]=e:d.push(e)}}else d=null;return b?d:e},setStorage:function(a,b){var c,e=[];var d=function(g,m){c||(c=r.lib.validate(g,"number")?"number":r.lib.validate(g,"date")?"date":r.lib.validate(g,"boolean")?"boolean":"string");g=r.lib.convert(g,"string");g=encodeURIComponent(g);r.lib.validate(m,"undefined")?e.push(g):(m=encodeURIComponent(m),e.push(m+"="+g))};if(r.lib.validate(b,"object"))for(var k in b)d(b[k],
k);else if(r.lib.validate(b,"array")){k=0;for(var n=b.length;k<n;k++)d(b[k])}else r.lib.validate(b,"null")||d(b);if(e=e.join("&"))if(e=c+"?"+e,window&&window.localStorage)try{localStorage.setItem(a,e);var f=!0}catch(g){f=!1}else f=r.lib.setCookie(a,e,31536E7,location.pathname,document.domain);else window&&window.localStorage?(localStorage.removeItem(a),f=!0):f=r.lib.delCookie(a,location.pathname,document.domain);return f},counter:function(){var a={};return function(b,c){var e=0;r.lib.validate(b,"array")&&
b.join("_");b&&(a[b]=a[b]||0,e=a[b],!1===c?delete a[b]:!0===c?a[b]++:c&&(a[b]+=c));return e}}(),on:function(){var a={};return function(b,c,e){var d,k=[],n=0;b=b.toString().split(/\s+/);for(var f=0,g=b.length;f<g;f++)if(d=b[f])if(a[d]||(a[d]=[0]),e)if(c){a[d][c]||(a[d][c]=[]);var m=a[d][c].length;a[d][c][m]=e;a[d][0]>=c&&k.push([d,c,m]);n++}else{m=1;for(var p=a[d].length;m<p;m++)if(a[d][m])for(var h=0,z=a[d][m].length;h<z;h++)a[d][m][h]===e&&(delete a[d][m][h],n++)}else if(a[d][0]++,c=c||a[d][0],a[d][c])for(m=
0;m<a[d][c].length;m++)a[d][c][m]&&k.push([d,c,m]),n++;f=0;for(g=k.length;f<g;f++)d=k[f][0],c=k[f][1],m=k[f][2],a[d]&&a[d][c]&&a[d][c][m]&&a[d][c][m].call(a[d][c][m],c);return n}}(),href:function(a){var b=document.createElement("a");b.href=a;return b.cloneNode(!1).href},getExt:function(a){var b="";var c=(""+a).lastIndexOf(".");-1!==c&&(b=a.substr(c+1),b=b.toLowerCase());return b},md5:function(a){var b=function(t,w){var x=t&2147483648;var y=w&2147483648;var A=t&1073741824;var B=w&1073741824;t=(t&1073741823)+
(w&1073741823);return A&B?t^2147483648^x^y:A|B?t&1073741824?t^3221225472^x^y:t^1073741824^x^y:t^x^y},c=function(t,w,x,y,A,B,C){t=b(t,b(b(w&x|~w&y,A),C));return b(t<<B|t>>>32-B,w)},e=function(t,w,x,y,A,B,C){t=b(t,b(b(w&y|x&~y,A),C));return b(t<<B|t>>>32-B,w)},d=function(t,w,x,y,A,B,C){t=b(t,b(b(w^x^y,A),C));return b(t<<B|t>>>32-B,w)},k=function(t,w,x,y,A,B,C){t=b(t,b(b(x^(w|~y),A),C));return b(t<<B|t>>>32-B,w)},n=function(t){var w="",x;for(x=0;3>=x;x++){var y=t>>>8*x&255;y="0"+y.toString(16);w+=y.substr(y.length-
2,2)}return w},f=[];a=function(t){t=t.replace(/\r\n/g,"\n");for(var w="",x=0;x<t.length;x++){var y=t.charCodeAt(x);128>y?w+=String.fromCharCode(y):(127<y&&2048>y?w+=String.fromCharCode(y>>6|192):(w+=String.fromCharCode(y>>12|224),w+=String.fromCharCode(y>>6&63|128)),w+=String.fromCharCode(y&63|128))}return w}(a.toString());f=function(t){var w=t.length;var x=w+8;for(var y=16*((x-x%64)/64+1),A=Array(y-1),B,C=0;C<w;)x=(C-C%4)/4,B=C%4*8,A[x]|=t.charCodeAt(C)<<B,C++;x=(C-C%4)/4;A[x]|=128<<C%4*8;A[y-2]=
w<<3;A[y-1]=w>>>29;return A}(a);var g=1732584193;var m=4023233417;var p=2562383102;var h=271733878;for(a=0;a<f.length;a+=16){var z=g;var q=m;var u=p;var v=h;g=c(g,m,p,h,f[a+0],7,3614090360);h=c(h,g,m,p,f[a+1],12,3905402710);p=c(p,h,g,m,f[a+2],17,606105819);m=c(m,p,h,g,f[a+3],22,3250441966);g=c(g,m,p,h,f[a+4],7,4118548399);h=c(h,g,m,p,f[a+5],12,1200080426);p=c(p,h,g,m,f[a+6],17,2821735955);m=c(m,p,h,g,f[a+7],22,4249261313);g=c(g,m,p,h,f[a+8],7,1770035416);h=c(h,g,m,p,f[a+9],12,2336552879);p=c(p,h,
g,m,f[a+10],17,4294925233);m=c(m,p,h,g,f[a+11],22,2304563134);g=c(g,m,p,h,f[a+12],7,1804603682);h=c(h,g,m,p,f[a+13],12,4254626195);p=c(p,h,g,m,f[a+14],17,2792965006);m=c(m,p,h,g,f[a+15],22,1236535329);g=e(g,m,p,h,f[a+1],5,4129170786);h=e(h,g,m,p,f[a+6],9,3225465664);p=e(p,h,g,m,f[a+11],14,643717713);m=e(m,p,h,g,f[a+0],20,3921069994);g=e(g,m,p,h,f[a+5],5,3593408605);h=e(h,g,m,p,f[a+10],9,38016083);p=e(p,h,g,m,f[a+15],14,3634488961);m=e(m,p,h,g,f[a+4],20,3889429448);g=e(g,m,p,h,f[a+9],5,568446438);
h=e(h,g,m,p,f[a+14],9,3275163606);p=e(p,h,g,m,f[a+3],14,4107603335);m=e(m,p,h,g,f[a+8],20,1163531501);g=e(g,m,p,h,f[a+13],5,2850285829);h=e(h,g,m,p,f[a+2],9,4243563512);p=e(p,h,g,m,f[a+7],14,1735328473);m=e(m,p,h,g,f[a+12],20,2368359562);g=d(g,m,p,h,f[a+5],4,4294588738);h=d(h,g,m,p,f[a+8],11,2272392833);p=d(p,h,g,m,f[a+11],16,1839030562);m=d(m,p,h,g,f[a+14],23,4259657740);g=d(g,m,p,h,f[a+1],4,2763975236);h=d(h,g,m,p,f[a+4],11,1272893353);p=d(p,h,g,m,f[a+7],16,4139469664);m=d(m,p,h,g,f[a+10],23,3200236656);
g=d(g,m,p,h,f[a+13],4,681279174);h=d(h,g,m,p,f[a+0],11,3936430074);p=d(p,h,g,m,f[a+3],16,3572445317);m=d(m,p,h,g,f[a+6],23,76029189);g=d(g,m,p,h,f[a+9],4,3654602809);h=d(h,g,m,p,f[a+12],11,3873151461);p=d(p,h,g,m,f[a+15],16,530742520);m=d(m,p,h,g,f[a+2],23,3299628645);g=k(g,m,p,h,f[a+0],6,4096336452);h=k(h,g,m,p,f[a+7],10,1126891415);p=k(p,h,g,m,f[a+14],15,2878612391);m=k(m,p,h,g,f[a+5],21,4237533241);g=k(g,m,p,h,f[a+12],6,1700485571);h=k(h,g,m,p,f[a+3],10,2399980690);p=k(p,h,g,m,f[a+10],15,4293915773);
m=k(m,p,h,g,f[a+1],21,2240044497);g=k(g,m,p,h,f[a+8],6,1873313359);h=k(h,g,m,p,f[a+15],10,4264355552);p=k(p,h,g,m,f[a+6],15,2734768916);m=k(m,p,h,g,f[a+13],21,1309151649);g=k(g,m,p,h,f[a+4],6,4149444226);h=k(h,g,m,p,f[a+11],10,3174756917);p=k(p,h,g,m,f[a+2],15,718787259);m=k(m,p,h,g,f[a+9],21,3951481745);g=b(g,z);m=b(m,q);p=b(p,u);h=b(h,v)}return(n(g)+n(m)+n(p)+n(h)).toLowerCase()},sha256:function(a){var b=function(e,d){var k=(e&65535)+(d&65535);return(e>>16)+(d>>16)+(k>>16)<<16|k&65535},c=function(e,
d){return e>>>d|e<<32-d};a=function(e){e=e.replace(/\r\n/g,"\n");for(var d="",k=0;k<e.length;k++){var n=e.charCodeAt(k);128>n?d+=String.fromCharCode(n):(127<n&&2048>n?d+=String.fromCharCode(n>>6|192):(d+=String.fromCharCode(n>>12|224),d+=String.fromCharCode(n>>6&63|128)),d+=String.fromCharCode(n&63|128))}return d}(a);return function(e){for(var d="",k=0;k<4*e.length;k++)d+="0123456789abcdef".charAt(e[k>>2]>>8*(3-k%4)+4&15)+"0123456789abcdef".charAt(e[k>>2]>>8*(3-k%4)&15);return d}(function(e,d){var k=
[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,
275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],n=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],f=Array(64),g,m;e[d>>5]|=128<<24-d%32;e[(d+64>>9<<4)+15]=d;for(g=0;g<e.length;g+=16){d=n[0];var p=n[1];var h=n[2];var z=n[3];var q=n[4];var u=n[5];var v=n[6];var t=n[7];for(m=0;64>m;m++){if(16>m)f[m]=e[m+g];else{var w=m;var x=f[m-
2];x=c(x,17)^c(x,19)^x>>>10;x=b(x,f[m-7]);var y=f[m-15];y=c(y,7)^c(y,18)^y>>>3;f[w]=b(b(x,y),f[m-16])}w=q;w=c(w,6)^c(w,11)^c(w,25);w=b(b(b(b(t,w),q&u^~q&v),k[m]),f[m]);t=d;t=c(t,2)^c(t,13)^c(t,22);x=b(t,d&p^d&h^p&h);t=v;v=u;u=q;q=b(z,w);z=h;h=p;p=d;d=b(w,x)}n[0]=b(d,n[0]);n[1]=b(p,n[1]);n[2]=b(h,n[2]);n[3]=b(z,n[3]);n[4]=b(q,n[4]);n[5]=b(u,n[5]);n[6]=b(v,n[6]);n[7]=b(t,n[7])}return n}(function(e){for(var d=[],k=0;k<8*e.length;k+=8)d[k>>5]|=(e.charCodeAt(k/8)&255)<<24-k%32;return d}(a),8*a.length))},
parseJSON:function(a){if(window&&window.JSON&&JSON.parse)try{var b=JSON.parse(a)}catch(c){b=eval("("+a+")")}else b=eval("("+a+")");return b},numDeclin:function(a,b,c,e){a=Number(a);a=Math.abs(a);a=Math.floor(a);var d=a%10;return 1!=(a%100-d)/10?0==d?b:1==d?c:5>d?e:b:b},num2str:function(a,b,c,e){var d,k;isNaN(b=Math.abs(b))&&(b=2);c==D&&(c=",");e==D&&(e=".");if(k=0>a)a=Math.abs(a);var n=parseInt(a=(+a||0).toFixed(b))+"";var f=(d=3<(d=n.length)?d%3:0)?n.substr(0,d)+e:"";e=n.substr(d).replace(/(\d{3})(?=\d)/g,
"$1"+e);a=b?c+Math.abs(a-n).toFixed(b).replace(/-/,0).slice(2):"";return(k?"-":"")+f+e+a},num2word:function(a,b,c){function e(t,w){t=t.toString().substr(-2);return w[0]+(/^[0,2-9]?[1]$/.test(t)?w[2]:/^[0,2-9]?[2-4]$/.test(t)?w[3]:w[1])}var d=[],k=[["ноль"],[,,,"три","четыре","пять","шесть","семь","восемь","девять"],"десять одиннадцать двенадцать тринадцать четырнадцать пятнадцать шестнадцать семнадцать восемнадцать девятнадцать".split(" "),[,,"двадцать","тридцать","сорок","пятьдесят","шестьдесят",
"семьдесят","восемьдесят","девяносто"],[,"сто","двести","триста","четыреста","пятьсот","шестьсот","семьсот","восемьсот","девятьсот"],[[,"один","два"],[,"одна","две"],[,"одно","два"]]],n=[["...ллион","ов","","а"],["тысяч","","а","и"],["миллион","ов","","а"],["миллиард","ов","","а"],["триллион","ов","","а"],["квадриллион","ов","","а"],["квинтиллион","ов","","а"],["секстилион","ов","","а"],["септилион","ов","","а"],["окталион","ов","","а"],["ноналион","ов","","а"],["декалион","ов","","а"],["эндекалион",
"ов","","а"],["додекалион","ов","","а"]],f=[[["цел","ых","ый","ых"],["цел","ых","ая","ых"],["цел","ых","ое","ых"]],["десят","ых","ая","ых"],["сот","ых","ая","ых"],["тясячн","ых","ая","ых"],["десятитысячн","ых","ая","ых"],["стотысячн","ых","ая","ых"],["милионн","ых","ая","ых"],["десятимилионн","ых","ая","ых"]];c=c||0;a=a.toString().split(".");for(var g=0,m=a.length;g<m;g++){g&&(a[g]=a[g].substr(0,f.length-1));l=a[g].length;a[g]=["","00","0"][a[g].split(/\d{3}/).join("").length]+a[g];for(var p=a[g].length,
h,z=0,q=-1,u=[];3*z<p;){h=a[g].substr(-3*(z+1),3);u[++q]=[];for(var v=0;2>=v;v++)if(0!=h[v])switch(v){case 0:u[q][u[q].length]=k[4][h[v]];break;case 1:1==h[v]?(u[q][u[q].length]=k[2][h[2]],v=3):u[q][u[q].length]=k[3][h[v]];break;case 2:u[q][u[q].length]=2>=h[v]?k[5][1==z||g?1:c][h[v]]:k[1][h[v]]}u[q].length||(u[q][u[q].length]=k[0][0]);0<h&&0<z&&(u[q][u[q].length]=e(h,n[z]));!z&&1<m&&(u[q][u[q].length]=e(h,g?f[l]:f[0][c]));z||!b||g||g!=m-1?!z&&b&&g&&(u[q][u[q].length]=b[0]+b[3]):u[q][u[q].length]=
e(h,b);u[q]=u[q].join(" ");z++}d[d.length]=u.reverse().join(" ")}return d.join(" ")},date2str:function(a,b){var c="Воскресенье Понедельник Вторник Среда Четверг Пятница Суббота".split(" "),e=" Января Февраля Марта Апреля Мая Июня Июля Августа Сентября Октября Ноября Декабря".split(" "),d={0:"ый",2:"ой",3:"ий",6:"ой",7:"ой",8:"ой",22:"ой",26:"ой",27:"ой",28:"ой"},k={"-660":"ST","-600":"HAST","-540":"AKT","-480":"AWST","-420":"CXT","-360":"СST","-300":"EST","-240":"AST","-210":"NST","-180":"ART",0:"GMT",
60:"CET",120:"CAT",180:"MSK",210:"IRST",300:"PKT",330:"IST",360:"BDT",390:"MST",420:"CXT",480:"AWST",540:"JST",570:"ACST",600:"AEST",660:"NFT"},n="";var f=function(z){var q="";switch(z){case "d":q+=r.lib.strPad(f("j"),2,"0","left");break;case "D":q+=f("l").substr(0,3);break;case "j":q+=a.getDate();break;case "l":q+=c[f("w")];break;case "N":q+=f("w")||7;break;case "S":q+=d[f("j")]||d[0];break;case "w":q+=a.getDay();break;case "z":q+=(a-new Date(a.getFullYear(),0,1))/864E5>>0;break;case "W":z=new Date(a.valueOf());
var u=(a.getDay()+6)%7;z.setDate(z.getDate()-u+3);u=z.valueOf();z.setMonth(0,1);4!==z.getDay()&&z.setMonth(0,1+(4-z.getDay()+7)%7);q+=1+Math.ceil((u-z)/6048E5);break;case "F":q+=e[f("n")];break;case "m":q+=r.lib.strPad(f("n"),2,"0","left");break;case "M":q+=f("F").substr(0,3);break;case "n":q+=a.getMonth()+1;break;case "t":q+=(new Date(a.getFullYear(),a.getMonth()+1,0)).getDate();break;case "L":q+=a.getFullYear()&3||!(a.getFullYear()%100)&&a.getFullYear()%400?0:1;break;case "o":(function(){var v=
new Date(a.valueOf());v.setDate(v.getDate()-(a.getDay()+6)%7+3);q+=v.getFullYear()})();break;case "Y":q+=a.getFullYear();break;case "y":q+=f("Y").substr(2,2);break;case "a":q+=11<a.getHours()?"pm":"am";break;case "A":q+=f("a").toUpperCase();break;case "B":(function(){var v=60*(a.getTimezoneOffset()+60);v=3600*a.getHours()+60*a.getMinutes()+a.getSeconds()+v;v=Math.floor(v/86.4);1E3<v&&(v-=1E3);0>v&&(v+=1E3);q+=r.lib.strPad(v,3,"0","left")})();break;case "g":q+=a.getHours()%12||12;break;case "G":q+=
a.getHours();break;case "h":q+=r.lib.strPad(f("g"),2,"0","left");break;case "H":q+=r.lib.strPad(f("G"),2,"0","left");break;case "i":q+=r.lib.strPad(a.getMinutes(),2,"0","left");break;case "s":q+=r.lib.strPad(a.getSeconds(),2,"0","left");break;case "u":q+=r.lib.strPad(1E3*a.getMilliseconds(),6,"0","left");break;case "e":q+=(new Date).toString().split(" ")[5].split("-")[0].split("+")[0];break;case "I":q+=(new Date(a.getFullYear(),0,1)).getTimezoneOffset()!=a.getTimezoneOffset()?1:0;break;case "O":q+=
(0<a.getTimezoneOffset()?"-":"+")+r.lib.strPad(Math.abs(a.getTimezoneOffset()/60*100),4,"0","left");break;case "P":q+=f("O").substr(0,3)+":"+f("O").substr(3,2);break;case "T":q+=k[-1*a.getTimezoneOffset()-60*Number(f("I"))]||k[0];break;case "Z":q+=-60*a.getTimezoneOffset();break;case "c":q+=f("Y")+"-"+f("m")+"-"+f("d")+"T"+f("h")+":"+f("i")+":"+f("s")+f("P");break;case "r":q+=f("D")+", "+f("j")+" "+f("M")+" "+f("Y")+" "+f("h")+":"+f("i")+":"+f("s")+" "+f("O");break;case "U":q+=Math.round(a.getTime()/
1E3)}return q};for(var g=0,m=b.length;g<m;g++){var p=b.charAt(g);n="\\"!==h?n+(f(p)||p):n+p;var h=p}return n},extend:function(){var a=arguments[0]||{},b=1,c=arguments.length,e=!1,d;r.lib.validate(a,"boolean")&&(e=a,a=arguments[1]||{},b=2);for(r.lib.validate(a,"object")||r.lib.validate(a,"function")||(a={});b<c;++b)if(null!=(d=arguments[b]))for(var k in d){var n=a[k],f=d[k];a!==f&&(e&&f&&r.lib.validate(f,"object")&&!f.nodeType?a[k]=r.lib.extend(e,n||(null!=f.length?[]:{}),f):r.lib.validate(f,"undefined")||
(a[k]=f))}return a},template:function(a,b,c){var e;if(a){b||(b={});a=a.toString();a=a.split("|");for(var d=a.length,k=d-1;-1<k;k--)if(e=a[k]){var n=!0;var f=e.split("{");for(var g=1,m=f.length;g<m;g++){e=f[g];var p=e.indexOf("}");if(~p){var h=e.substr(0,p);var z=h.split(">");var q=z.shift().split(".");if(r.lib.validate(b,"function"))h=b(q),n=!r.lib.validate(h,"undefined");else{h=b;for(var u=0,v=q.length;n&&u<v;u++){var t=q[u];(n=t in h)&&(h=h[t])}}u=0;for(v=z.length;n&&u<v;u++)n=z[u],c?(h=c(n,h),
n=!r.lib.validate(h,"undefined")):n=!1;n&&(p+=1,e=h+e.substr(p))}else e="{"+e;f[g]=e}e=f.join("");n?a[k]=e:a.splice(k,1)}else k&&k<d-1&&(a[k]="|");b=a.join("")}else b="";return b},getRandomString:function(a,b){var c="";b||(b=89);b=Math.min(Math.max(b,1),89);for(var e=0;e<a;e++)c+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()-_+=;:,./?|`~[]{}".charAt(Math.round(Math.random()*(b-1)));return c}}})(App.prototype);

// 0.1.2 функци для работы в среде windows script host
(function(q,t,u){q.wsh={getLDAP:function(b,d,f,a,g){var m=[],n=[],c=0;if(!c){var e=new ActiveXObject("ADODB.Connection");var r=new ActiveXObject("NameTranslate");var h=new ActiveXObject("ADODB.Command")}c||(e.provider="ADsDSOObject",a&&(e.properties("User ID").value=a),g&&(e.properties("Password").value=g),e.open("Active Directory Provider"),h.activeConnection=e,h.properties("Searchscope").value=2,h.properties("Page Size").value=100);if(!c)if(f)var l=f;else f=GetObject("LDAP://RootDSE"),l=f.get("DefaultNamingContext");
c||(n=[b],d&&n.push(d));for(g=n.length-1;!c&&-1<g;g--){b=n[g];d=f=null;e="SELECT distinguishedName FROM 'LDAP://"+l+"'";if(!c&&b&&!d&&q.lib.validate(b,"guid")){a=(""+b).toUpperCase();try{r.init(3,""),r.set(7,a),d=r.get(1)}catch(p){c=1}}if(!c&&b&&!d)try{(d=b.get("distinguishedName"))&&(f=b)}catch(p){}if(!c&&b&&!d){a=e+" WHERE name = '"+b+"' OR sAMAccountName = '"+b+"' OR distinguishedName = '"+b+"'";try{h.commandText=a;var k=h.execute();k.recordCount&&(d=k.fields("distinguishedName").value)}catch(p){}}if(!c&&
!d){b?(a=""+b,a=q.lib.template(a,{protocol:"LDAP:",parent:l,select:e}),a.toUpperCase().indexOf("WHERE")?a.toUpperCase().indexOf("SELECT")&&(c=2):a=e+" "+a):a=g?e+" WHERE distinguishedName = '"+l+"'":e;try{h.commandText=a,k=h.execute(),k.recordCount||(c=4)}catch(p){c=3}}if(!c&&d&&!g)if(f)m.push(f);else{a=d;try{f=GetObject("LDAP://"+a),m.push(f)}catch(p){c=5}}if(!c&&!d)for(b=0,e=k.recordCount;b<e;k.moveNext(),b++)a=k.fields("distinguishedName").value,b||(d=a),!g&&b&&(f=GetObject("LDAP://"+a),m.push(f));
c||(l=d)}return m}}})(App.prototype,WSH);

// 0.0.1 расширяем глобальные функции среды
function setEnv(env, key, value) { env(key) = value; }

// 0.1.3 определяет дополнительные переменные среды
var env=new App({aptPref:"apt",aptLen:3,aptNone:"XXX",wsPref:"c",wsLen:1,wsFirstDesc:"Основной",wsNextDesc:"Дополнительный",wsNoneDesc:"Временный",supportLogin:"apteka",supportToken:"beb120e2949d34cd65a82b16071e8836",runStyle:1,defReturn:99,driveMinSize:27917287424,argWrap:'"',keyWrap:"%",argDelim:" ",getDelim:"+",setDelim:"#",csvDelim:";",envType:"Process"});
(function(x,d,H){d.lib.extend(d,{fun:{wql2date:function(h){return new Date(Date.UTC(1*h.substr(0,4),1*h.substr(4,2)-1,1*h.substr(6,2),1*h.substr(8,2),1*h.substr(10,2)-1*h.substr(21,4),1*h.substr(12,2),1*h.substr(14,3)))},bin2key:function(h){var m="";var r=h.toArray();h=Math.floor(r[66]/6)&1;r[66]=r[66]&247|4*(h&2);for(var v=24;-1<v;v--){var t=0;for(var c=14;-1<c;c--)t*=256,t=r[c+52]+t,r[c+52]=Math.floor(t/24),t%=24;m="BCDFGHJKMPQRTVWXY2346789".substr(t,1)+m}1==h&&(h=m.substr(1,t),m=m.substr(1).replace(h,
h+"N"));return[m.substr(0,5),m.substr(5,5),m.substr(10,5),m.substr(15,5),m.substr(20,5)].join("-")},info2str:function(h,m,r){if(!r||2>r)r=1024;if(!m||0>m)m=0;var v=Math.pow(10,m);for(var t=-1;h>=r;t++)h/=r;h=Math.ceil(h*v)/v;h=d.lib.num2str(h,-1<t?m:0,",","");return h+=" "+"КМГТПЭЗЙ".charAt(t)},clear:function(h){h=h?""+h:"";"INVALID"==h&&(h="");"To be filled by O.E.M."==h&&(h="");"Default string"==h&&(h="");"empty"==h&&(h="");"None"==h&&(h="");for(var m=1,r=arguments.length;m<r;m++)h=h.replace(arguments[m],
"");return h.replace(/^['"]|["']$/g,"").replace(/^\s+|\s+$/g,"").replace(/\.+$/,"").replace(/\(R\)/gi,"").replace(/\(Registered Trademark\)/gi,"").replace(/\(Microsoft Corporation\)/gi,"").replace(/\(Корпорация Майкрософт\)/gi,"").replace(/\(Майкрософт\)/gi,"").replace(/\(TM\)/gi,"").replace(/\s(?=\s)/gi,"")},repair:function(h){return("'"+(h?h:"")+"'").replace(/\\/g,"\\\\")}},init:function(){var h,m=0,r=0,v="",t="",c={};var F=new Date;var q=".";if(0<x.arguments.length){var a=x.arguments.item(0);a.indexOf("\\\\")||
-1!=a.indexOf("\\",2)||(q=h=a.substr(2),r++)}var E=new ActiveXObject("WScript.Shell");var y=new ActiveXObject("MSXML2.DOMDocument");var z=new ActiveXObject("Scripting.FileSystemObject");var w=new ActiveXObject("wbemScripting.Swbemlocator");w.security_.impersonationLevel=3;try{var p=w.connectServer(q,"root\\CIMV2");var u=w.connectServer(q,"root\\default").get("stdRegProv")}catch(G){p=null}if(p){var e=u.methods_.item("getBinaryValue");var b=e.inParameters.spawnInstance_();b.hDefKey=2147483650;b.sSubKeyName=
"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion";b.sValueName="DigitalProductId";b=u.execMethod_(e.name,b);b.returnValue||(a=d.fun.bin2key(b.uValue))&&"BBBBB-BBBBB-BBBBB-BBBBB-BBBBB"!=a&&(c["SYS-KEY"]=a);response=p.execQuery("SELECT * FROM Win32_OperatingSystem WHERE primary = TRUE");for(e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();if(a=b.systemDrive)var n=a;if(a=b.localDateTime)F=d.fun.wql2date(a);if(a=d.fun.clear(b.caption,"Майкрософт","Microsoft","Edition","x64",","))c["SYS-NAME"]=
a;if(a=d.fun.clear(b.version))c["SYS-VERSION"]=a;if(a=b.localDateTime)c["SYS-TIME"]=d.lib.date2str(d.fun.wql2date(a),"d.m.Y H:i:s");if(a=d.fun.clear(b.systemDrive))c["SYS-DRIVE"]=a;if(a=b.installDate)c["SYS-INSTALL"]=d.lib.date2str(d.fun.wql2date(a),"d.m.Y H:i:s");if(a=b.lastBootUpTime)c["SYS-RESET"]=d.lib.date2str(d.fun.wql2date(a),"d.m.Y H:i:s");if(a=d.fun.clear(b.serialNumber))c["SYS-SERIAL"]=a;if(a=d.fun.clear(b.description))c["SYS-DESCRIPTION"]=a;c["SYS-ARCHITECTURE"]=b.osArchitecture&&!b.osArchitecture.indexOf("64")?
"x64":"x86";break}response=p.execQuery("SELECT manufacturer, product, serialNumber FROM Win32_BaseBoard WHERE hostingBoard = TRUE");for(e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();if(a=d.fun.clear(b.product))c["PCB-NAME"]=a;a&&(a=d.fun.clear(b.manufacturer))&&(c["PCB-NAME"]=a.split(" ")[0]+" "+d.fun.clear(b.product));if(a=d.fun.clear(b.serialNumber))c["PCB-SERIAL"]=a;break}q="";response=p.execQuery("SELECT * FROM Win32_NetworkAdapterConfiguration WHERE ipEnabled = TRUE");for(e=
new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();if(a=b.interfaceIndex)q=a;if(null!=b.ipAddress){var f=b.ipAddress.toArray();for(var g=0,l=f.length;g<l;g++)(a=d.fun.clear(f[g]))&&-1!=a.indexOf(".")&&!c["NET-IP-V4"]&&(c["NET-IP-V4"]=a),a&&-1==a.indexOf(".")&&!c["NET-IP-V6"]&&(c["NET-IP-V6"]=a)}if(null!=b.defaultIPGateway)for(f=b.defaultIPGateway.toArray(),g=0,l=f.length;g<l;g++)(a=d.fun.clear(f[g]))&&-1!=a.indexOf(".")&&!c["NET-GATEWAY-V4"]&&(c["NET-GATEWAY-V4"]=a),a&&-1==a.indexOf(".")&&
!c["NET-GATEWAY-V6"]&&(c["NET-GATEWAY-V6"]=a);if(null!=b.dnsServerSearchOrder)for(f=b.dnsServerSearchOrder.toArray(),g=0,l=f.length;g<l;g++)(a=d.fun.clear(f[g]))&&-1!=a.indexOf(".")&&!c["NET-DNS-V4"]&&(c["NET-DNS-V4"]=a),a&&-1==a.indexOf(".")&&!c["NET-DNS-V6"]&&(c["NET-DNS-V6"]=a);if(null!=b.ipSubnet)for(f=b.ipSubnet.toArray(),g=0,l=f.length;g<l;g++)(a=d.fun.clear(f[g]))&&-1!=a.indexOf(".")&&!c["NET-SUBNET-V4"]&&(c["NET-SUBNET-V4"]=a),a&&-1==a.indexOf(".")&&!c["NET-SUBNET-V6"]&&(c["NET-SUBNET-V6"]=
a);if(a=d.fun.clear(b.dhcpServer))c["NET-DHCP-V4"]=a;if(a=d.fun.clear(b.description,"Сетевой адаптер","Адаптер","для виртуальной сети","Сетевая карта","Контроллер","NIC (NDIS 6.20)","- Минипорт планировщика пакетов"))c["NET-NAME"]=a;if(a=d.fun.clear(b.macAddress))c["NET-MAC"]=a;break}f=0;response=p.execQuery("SELECT speed, timeOfLastReset FROM Win32_NetworkAdapter WHERE netEnabled = TRUE AND interfaceIndex = "+d.fun.repair(q));for(e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();if(a=
b.speed)c["NET-SPEED"]=d.fun.info2str(a,0,1E3)+"бит/с";if(a=b.speed)c["NET-SPEED-VAL"]=a;if(a=b.timeOfLastReset)c["NET-RESET"]=d.lib.date2str(d.fun.wql2date(a),"d.m.Y H:i:s");if(a=b.speed)f+=8.12567*Math.sqrt(a/100/1E3/1E3);break}f&&(m=m?Math.min(m,f):f);q="";response=p.execQuery("SELECT * FROM Win32_ComputerSystem");for(e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();if(a=b.dnsHostName)v=a;if(a=b.name)v||(v=a.toLowerCase());b.domain!=b.workgroup&&(t=b.domain);if(a=b.userName)var C=
q=a;if(a=b.userName)var A=a.split("\\")[0];if(a=b.userName)var B=a.split("\\")[1];if(a=d.fun.clear(v))c["NET-HOST"]=a;if(a=d.fun.clear(b.domain))c["NET-DOMAIN"]=a;if(a=d.fun.clear(C))c["USR-LOGIN"]=a;if(a=d.fun.clear(A))c["USR-DOMAIN"]=a;if(a=d.fun.clear(B))c["USR-ACCOUNT"]=a;break}if(!q){f=[];e=u.methods_.item("getStringValue");b=e.inParameters.spawnInstance_();b.hDefKey=2147483650;b.sSubKeyName="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon";b.sValueName="DefaultDomainName";b=u.execMethod_(e.name,
b);!b.returnValue&&b.sValue&&f.push(b.sValue);e=u.methods_.item("getStringValue");b=e.inParameters.spawnInstance_();b.hDefKey=2147483650;b.sSubKeyName="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon";b.sValueName="DefaultUserName";b=u.execMethod_(e.name,b);!b.returnValue&&b.sValue&&f.push(b.sValue);2==f.length&&(C=f.join("\\"));2==f.length&&(A=f[0]);2==f.length&&(B=f[1]);if(a=d.fun.clear(C))c["USR-LOGIN"]=a;if(a=d.fun.clear(A))c["USR-DOMAIN"]=a;if(a=d.fun.clear(B))c["USR-ACCOUNT"]=a}response=
p.execQuery("SELECT fullName, sid FROM Win32_UserAccount WHERE domain = "+d.fun.repair(A)+" AND name = "+d.fun.repair(B));for(e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();if(a=b.sid)var D=a;if(a=d.fun.clear(b.fullName))c["USR-NAME"]=a;if(a=d.fun.clear(D))c["USR-SID"]=a;break}try{for(response=w.connectServer(t,"root\\CIMV2").execQuery("SELECT fullName, sid FROM Win32_UserAccount WHERE domain = "+d.fun.repair(A)+" AND name = "+d.fun.repair(B)),e=new Enumerator(response);!e.atEnd();){b=
e.item();e.moveNext();if(a=b.sid)D=a;if(a=d.fun.clear(b.fullName))c["USR-NAME"]=a;if(a=d.fun.clear(D))c["USR-SID"]=a;break}}catch(G){}response=p.execQuery("SELECT localPath FROM Win32_UserProfile WHERE sid = "+d.fun.repair(D));for(e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();if(a=d.fun.clear(b.localPath))c["USR-PROFILE"]=a;break}response=p.execQuery("SELECT homeDirectory FROM Win32_NetworkLoginProfile WHERE name = "+d.fun.repair(C));for(e=new Enumerator(response);!e.atEnd();){b=
e.item();e.moveNext();if(a=d.fun.clear(b.homeDirectory))c["USR-HOME"]=a;break}f=0;response=p.execQuery("SELECT architecture, maxClockSpeed, name, revision, numberOfCores, socketDesignation FROM Win32_Processor WHERE role = 'CPU'");for(e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();0==b.architecture?c["CPU-ARCHITECTURE"]="x86":9==b.architecture&&(c["CPU-ARCHITECTURE"]="x64");if(a=b.maxClockSpeed)c["CPU-SPEED"]=d.fun.info2str(1E6*a,2,1E3)+"Гц";if(a=b.maxClockSpeed)c["CPU-SPEED-VAL"]=
1E6*a;if(a=d.fun.clear(b.name,"CPU","APU","Процессор","Processor","with","Radeon HD Graphics"))c["CPU-NAME"]=a;if(a=d.fun.clear(b.revision))c["CPU-VERSION"]=a;if(a=b.numberOfCores)c["CPU-CORE"]=a;if(a=d.fun.clear(b.socketDesignation,"SOCKET 0"))c["CPU-SOCKET"]=a;if(a=b.maxClockSpeed)f+=2.26143*Math.sqrt(a/1E3);if(a=b.numberOfCores)f*=1.02033*Math.sqrt(a);break}f&&(m=m?Math.min(m,f):f);response=p.execQuery("SELECT level, maxCacheSize FROM Win32_CacheMemory");for(e=new Enumerator(response);!e.atEnd();)if(b=
e.item(),e.moveNext(),a=b.maxCacheSize)c["CPU-CACHE-L"+(b.level-2)]=d.fun.info2str(1024*a,0)+"Б";var k=f=0;response=p.execQuery("SELECT capacity, speed FROM Win32_PhysicalMemory");for(e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();if(a=b.capacity)c["RAM-SIZE-VAL"]=k+=1*a;b.capacity&&(c["RAM-SIZE"]=d.fun.info2str(k,0)+"Б");if(a=b.speed)c["RAM-SPEED"]=a+" МГц";if(a=b.speed)c["RAM-SPEED-VAL"]=1E6*a;if(a=k)f=2.51143*Math.sqrt(a/1024/1024/1024);if(a=b.speed)f*=.92245*Math.sqrt(a/1E3)}f&&
(m=m?Math.min(m,f):f);response=p.execQuery("SELECT adapterRam, name, driverVersion, currentHorizontalResolution, currentRefreshRate, currentBitsPerPixel, currentVerticalResolution FROM Win32_VideoController");for(e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();if(a=b.adapterRam)c["GPU-SIZE"]=d.fun.info2str(Math.abs(a),0)+"Б";if(a=b.adapterRam)c["GPU-SIZE-VAL"]=Math.abs(a);if(a=d.fun.clear(b.name,"GPU","Видеоустройство","Family","Chipset","Series","Graphics"))c["GPU-NAME"]=a;if(a=d.fun.clear(b.driverVersion))c["GPU-VERSION"]=
a;b.currentHorizontalResolution&&b.currentVerticalResolution&&(c["GPU-RESOLUTION"]=b.currentHorizontalResolution+" x "+b.currentVerticalResolution);if(a=b.currentHorizontalResolution)c["GPU-RESOLUTION-X"]=a;if(a=b.currentVerticalResolution)c["GPU-RESOLUTION-Y"]=a;if(a=b.currentRefreshRate)c["GPU-FREQUENCY"]=d.fun.info2str(a,0,1E3)+"Гц";if(a=b.currentRefreshRate)c["GPU-FREQUENCY-VAL"]=a;if(a=b.currentBitsPerPixel)c["GPU-COLOR"]=d.fun.info2str(a,0)+"бит"+d.lib.numDeclin(a,"","","а");if(a=b.currentBitsPerPixel)c["GPU-COLOR-VAL"]=
a;break}f=0;response=p.execQuery("SELECT * FROM Win32_DiskDrive");for(e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();switch(b.mediaType){case "Removable Media":k="USB";break;case "Fixed\thard disk media":case "Fixed hard disk media":k=b.caption&&-1!=b.caption.indexOf("Solid")?"SSD":b.caption&&-1!=b.caption.indexOf("SSD")?"SSD":b.caption&&!b.caption.indexOf("ADATA")?"SSD":"HDD";break;default:k=""}if((!b.caption||-1==b.caption.indexOf("Raid"))&&k&&!c[k+"-NAME"]){if(a=d.fun.clear(b.caption,
"ATA Device","SCSI Disk Device","USB Device","SSD"))c[k+"-NAME"]=a;if(a=d.fun.clear(b.firmwareRevision))c[k+"-VERSION"]=a;if(a=d.fun.clear(b.interfaceType))c[k+"-TYPE"]=a;if(a=d.fun.clear(b.serialNumber))c[k+"-SERIAL"]=a;if(a=b.size)c[k+"-SIZE"]=d.fun.info2str(a,0)+"Б";if(a=b.size)c[k+"-SIZE-VAL"]=a;if(a=k)f=Math.max(f,"SDD"==a?15.51143:7.14577)}}f&&(m=m?Math.min(m,f):f);response=p.execQuery("SELECT mediaType, caption, drive FROM Win32_CDROMDrive");for(e=new Enumerator(response);!e.atEnd();)if(b=
e.item(),e.moveNext(),!b.caption||-1==b.caption.indexOf("Alcohol"))if(!b.caption||-1==b.caption.indexOf("Virtual")){switch(b.mediaType){case "CD-ROM":c["ROM-TYPE"]="CD";break;case "DVD-ROM":c["ROM-TYPE"]="DVD";break;case "CD Writer":c["ROM-TYPE"]="CD-RW";break;case "DVD Writer":c["ROM-TYPE"]="DVD-RW"}if(a=d.fun.clear(b.caption,"ATA Device","SCSI CdRom Device"))c["ROM-NAME"]=a;if(a=d.fun.clear(b.drive))c["ROM-DRIVE"]=a;break}response=p.execQuery("SELECT caption, size FROM Win32_LogicalDisk WHERE driveType = 2 OR driveType = 3 OR driveType = 4");
for(e=new Enumerator(response);!e.atEnd();)b=e.item(),e.moveNext(),b.caption&&-1!=b.caption.indexOf(n)||c["BAK-DRIVE"]||(a=d.fun.clear(b.caption))&&b.size>=d.val.driveMinSize&&(c["BAK-DRIVE"]=a);q="";k="DisplayIcon";f=["SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\F3 TAIL","SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\F3 TAIL","SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\еФарма","SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\еФарма"];
a="";e=u.methods_.item("getStringValue");g=0;for(l=f.length;g<l&&!a;g++)b=e.inParameters.spawnInstance_(),b.hDefKey=2147483650,b.sSubKeyName=f[g],b.sValueName=k,b=u.execMethod_(e.name,b),!b.returnValue&&b.sValue&&(a=d.fun.clear(b.sValue));a&&(f=a.split("\\"),f.pop(),f.pop(),q=f.join("\\"),c["APP-EFARMA-DIR"]=q);n="";k="\\Client\\ePlus.Client.exe";f=[q];a="";g=0;for(l=f.length;g<l;g++)g&&(a+=" OR "),a+="name = "+d.fun.repair(f[g]+k);response=p.execQuery("SELECT name FROM CIM_DataFile WHERE "+a);for(e=
new Enumerator(response);!e.atEnd();)for(b=e.item(),e.moveNext(),g=0,l=f.length;g<l;g++)if(a=f[g]+k,b.name&&b.name.toLowerCase()==a.toLowerCase()){c["APP-EFARMA-CLIENT"]=n=a;break}if(n&&(k="ConnectionString",a=n+".Config",h&&(a=["\\",h,a.replace(":","$")].join("\\")),z.fileExists(a)&&y.load(a)))for(e=y.getElementsByTagName("appSettings"),g=0,l=e.length;g<l;g++)for(n=0,w=e.item(g).childNodes.length;n<w;n++)if(b=e.item(g).childNodes.item(n),1==b.nodeType&&k==b.getAttribute("key")){a=b.getAttribute("value");
b=d.lib.str2obj(a,!1,";","=");if(a=b["Data Source"])c["APP-EFARMA-CLIENT-SERVER"]=a;if(a=b["Initial Catalog"])c["APP-EFARMA-CLIENT-BASE"]=a;if(a=b["User ID"])c["APP-EFARMA-CLIENT-LOGIN"]=a;if(a=b.Password)c["APP-EFARMA-CLIENT-PASSWORD"]=a;break}n="";k="\\ARM\\ePlus.ARMCasherNew.exe";f=[q];a="";g=0;for(l=f.length;g<l;g++)g&&(a+=" OR "),a+="name = "+d.fun.repair(f[g]+k);response=p.execQuery("SELECT name FROM CIM_DataFile WHERE "+a);for(e=new Enumerator(response);!e.atEnd();)for(b=e.item(),e.moveNext(),
g=0,l=f.length;g<l;g++)if(a=f[g]+k,b.name&&b.name.toLowerCase()==a.toLowerCase()){c["APP-EFARMA-CASHER"]=n=a;break}if(n&&(k="LocalConnectionString",a=n+".Config",h&&(a=["\\",h,a.replace(":","$")].join("\\")),z.fileExists(a)&&y.load(a)))for(e=y.getElementsByTagName("appSettings"),g=0,l=e.length;g<l;g++)for(n=0,w=e.item(g).childNodes.length;n<w;n++)if(b=e.item(g).childNodes.item(n),1==b.nodeType&&k==b.getAttribute("key")){a=b.getAttribute("value");b=d.lib.str2obj(a,!1,";","=");if(a=b["Data Source"])c["APP-EFARMA-CASHER-SERVER"]=
a;if(a=b["Initial Catalog"])c["APP-EFARMA-CASHER-BASE"]=a;if(a=b["User ID"])c["APP-EFARMA-CASHER-LOGIN"]=a;if(a=b.Password)c["APP-EFARMA-CASHER-PASSWORD"]=a;break}n="";k="\\UpdateServer\\ePlus.UpdateServer.exe";f=[q];a="";g=0;for(l=f.length;g<l;g++)g&&(a+=" OR "),a+="name = "+d.fun.repair(f[g]+k);response=p.execQuery("SELECT name FROM CIM_DataFile WHERE "+a);for(e=new Enumerator(response);!e.atEnd();)for(b=e.item(),e.moveNext(),g=0,l=f.length;g<l;g++)if(a=f[g]+k,b.name&&b.name.toLowerCase()==a.toLowerCase()){c["APP-EFARMA-UPDATER"]=
n=a;break}if(n&&(a=n+".Config",h&&(a=["\\",h,a.replace(":","$")].join("\\")),z.fileExists(a)&&y.load(a)))for(e=y.getElementsByTagName("appSettings"),g=0,l=e.length;g<l;g++)for(n=0,w=e.item(g).childNodes.length;n<w;n++)if(b=e.item(g).childNodes.item(n),1==b.nodeType)switch(a=b.getAttribute("value"),b.getAttribute("key")){case "LocalUrl":a&&(c["APP-EFARMA-UPDATE-DIR"]=a);break;case "BackupDbFolder":a&&(c["APP-EFARMA-BACKUP-DIR"]=a)}k="lic";f=[q+"\\UpdateServer\\",q+"\\Client\\",q+"\\ARM\\"];a="";g=
0;for(l=f.length;g<l;g++)g&&(a+=" OR "),a+="drive = "+d.fun.repair(d.lib.strim(f[g],"",":",!0,!1))+" ",a+="AND path = "+d.fun.repair(d.lib.strim(f[g],":","",!1,!1))+" ",a+="AND extension = "+d.fun.repair(k);response=p.execQuery("SELECT name, fileName FROM CIM_DataFile WHERE "+a);for(e=new Enumerator(response);!e.atEnd();)for(b=e.item(),e.moveNext(),g=0,l=f.length;g<l;g++)if(a=f[g]+b.fileName+"."+k,b.name&&b.name.toLowerCase()==a.toLowerCase()){c["APP-EFARMA-LICENSE"]=a;break}a=d.lib.date2str(F,"Y");
k="\\ULUS.exe";f=["C:\\SoftLink\\Ulus\\"+a,"C:\\LO\\ULUS\\"+a,"C:\\so\\Ulus\\"+a,"C:\\ULUS\\"+a];a="";g=0;for(l=f.length;g<l;g++)g&&(a+=" OR "),a+="name = "+d.fun.repair(f[g]+k);response=p.execQuery("SELECT name FROM CIM_DataFile WHERE "+a);for(e=new Enumerator(response);!e.atEnd();)for(b=e.item(),e.moveNext(),g=0,l=f.length;g<l;g++)if(a=f[g]+k,b.name&&b.name.toLowerCase()==a.toLowerCase()){c["APP-ULUS"]=a;c["APP-ULUS-DIR"]=f[g];break}k="";f=["SOFTWARE\\Clients\\StartMenuInternet\\Google Chrome\\shell\\open\\command",
"SOFTWARE\\WOW6432Node\\Clients\\StartMenuInternet\\Google Chrome\\shell\\open\\command"];a="";e=u.methods_.item("getStringValue");g=0;for(l=f.length;g<l&&!a;g++)b=e.inParameters.spawnInstance_(),b.hDefKey=2147483650,b.sSubKeyName=f[g],b.sValueName=k,b=u.execMethod_(e.name,b),!b.returnValue&&b.sValue&&(a=d.fun.clear(b.sValue));a&&(f=a.split("\\"),f.pop(),c["APP-CHROME"]=a,c["APP-CHROME-DIR"]=f.join("\\"));k="";f=["SOFTWARE\\VideoLAN\\VLC","SOFTWARE\\WOW6432Node\\VideoLAN\\VLC"];a="";e=u.methods_.item("getStringValue");
g=0;for(l=f.length;g<l&&!a;g++)b=e.inParameters.spawnInstance_(),b.hDefKey=2147483650,b.sSubKeyName=f[g],b.sValueName=k,b=u.execMethod_(e.name,b),!b.returnValue&&b.sValue&&(a=d.fun.clear(b.sValue));a&&(f=a.split("\\"),f.pop(),c["APP-VLC"]=a,c["APP-VLC-DIR"]=f.join("\\"));k="ClientID";f=["SOFTWARE\\TeamViewer","SOFTWARE\\WOW6432Node\\TeamViewer"];a="";e=u.methods_.item("getDWORDValue");g=0;for(l=f.length;g<l&&!a;g++)b=e.inParameters.spawnInstance_(),b.hDefKey=2147483650,b.sSubKeyName=f[g],b.sValueName=
k,b=u.execMethod_(e.name,b),!b.returnValue&&b.uValue&&(a=d.fun.clear(b.uValue));a&&(c["APP-TEAMVIEWER-ID"]=a);a=v.toLowerCase();0==a.indexOf(d.val.aptPref)&&(a=a.substr(d.val.aptPref.length,d.val.aptLen),isNaN(a)||(c["APT-NUMBER"]=a||d.val.aptNone,c["APT-NUMBER-VAL"]=Number(a)));a=v.toLowerCase();0==a.indexOf(d.val.aptPref)&&((a=a.substr(d.val.aptPref.length+d.val.aptLen))?0==a.indexOf(d.val.wsPref)?(a=a.substr(d.val.wsPref.length,d.val.wsLen),a=isNaN(a)?0:Number(a)):a=0:a=1,c["APT-COMPUTER-VAL"]=
a,c["APT-COMPUTER"]=0==a?d.val.wsNoneDesc:1==a?d.val.wsFirstDesc:d.val.wsNextDesc);a=v.toLowerCase();0==a.indexOf(d.val.aptPref)&&(a=a.substr(d.val.aptPref.length,d.val.aptLen),isNaN(a)||(f=[d.val.supportLogin,Number(a),d.val.supportToken],c["APT-SUPPORT-HASH"]=d.lib.md5(f.join("")),c["APT-SUPPORT-LOGIN"]=d.val.supportLogin));f=[];c["CPU-NAME"]&&c["CPU-CORE"]&&c["CPU-SPEED"]&&f.push(d.fun.clear(c["CPU-NAME"].replace("Dual-Core","Intel"),"Dual Core","Xeon","Pentium","Celeron","Core2 Duo","Core","Processor",
"Athlon 64","Athlon",/,.+/,/@.+/,/\d\.d+GHz/)+" "+c["CPU-CORE"]+"x"+c["CPU-SPEED"].replace(",",".").replace(" МГц","M").replace(" ГГц","G")+"Hz");c["RAM-SIZE"]&&c["RAM-SPEED"]&&f.push(c["RAM-SIZE"].replace(" МБ","MB").replace(" ГБ","GB")+" "+c["RAM-SPEED"].replace(" МГц","M").replace(" ГГц","G")+"Hz");c["GPU-SIZE"]&&c["GPU-NAME"]&&(-1!=c["GPU-NAME"].indexOf("GeForce")||-1!=c["GPU-NAME"].indexOf("Radeon"))&&f.push(c["GPU-SIZE"].replace(" МБ","MB").replace(" ГБ","GB")+" "+d.fun.clear(c["GPU-NAME"],
"AMD","NVIDIA","GeForce","Radeon",/\(.+/));c["HDD-SIZE"]&&f.push(c["HDD-SIZE"].replace(" МБ","MB").replace(" ГБ","GB").replace(" ТБ","TB")+" HDD");c["SSD-SIZE"]&&f.push(c["SSD-SIZE"].replace(" МБ","MB").replace(" ГБ","GB").replace(" ТБ","TB")+" SSD");c["USB-SIZE"]&&f.push(c["USB-SIZE"].replace(" МБ","MB").replace(" ГБ","GB").replace(" ТБ","TB")+" USB");c["ROM-TYPE"]&&f.push(c["ROM-TYPE"]);f.length&&(c["DEV-NAME"]=f.join("/"));m&&(c["DEV-BENCHMARK"]=d.lib.num2str(m,5,",",""))}e=E.environment(d.val.envType);
for(k in c)a=c[k],setEnv(e,k,a);e=[];g=0;for(l=x.arguments.length-r;g<l;g++)if(a=x.arguments.item(g+r),a=a.split(d.val.getDelim).join(d.val.setDelim),g||"silent"!=a)if(g||"print"!=a)if(g||"csv"!=a)a=E.expandEnvironmentStrings(a),-1!=a.indexOf(d.val.argDelim)&&(a=d.val.argWrap+a+d.val.argWrap),e.push(a);else{f="SYS-KEY SYS-NAME SYS-VERSION SYS-TIME SYS-ARCHITECTURE SYS-DRIVE SYS-INSTALL SYS-RESET SYS-SERIAL PCB-NAME PCB-SERIAL NET-IP-V4 NET-GATEWAY-V4 NET-DNS-V4 NET-SUBNET-V4 NET-DHCP-V4 NET-NAME NET-MAC NET-SPEED NET-RESET NET-HOST NET-DOMAIN USR-LOGIN USR-DOMAIN USR-ACCOUNT USR-NAME USR-SID USR-PROFILE CPU-ARCHITECTURE CPU-SPEED CPU-NAME CPU-CORE CPU-SOCKET CPU-CACHE-L1 CPU-CACHE-L2 CPU-CACHE-L3 RAM-SIZE RAM-SPEED GPU-SIZE GPU-NAME GPU-VERSION GPU-RESOLUTION GPU-FREQUENCY GPU-COLOR SSD-NAME SSD-VERSION SSD-TYPE SSD-SERIAL SSD-SIZE HDD-NAME HDD-VERSION HDD-TYPE HDD-SERIAL HDD-SIZE USB-NAME USB-VERSION USB-TYPE USB-SERIAL USB-SIZE ROM-TYPE ROM-NAME ROM-DRIVE ROM-VERSION DEV-NAME DEV-BENCHMARK".split(" ");
n=0;for(w=f.length;n<w;n++)k=f[n],f[n]=c[k]?c[k]:"";x.echo(f.join(d.val.csvDelim))}else x.echo(d.lib.obj2str(c,!1,"\r\n"," = "));else d.val.runStyle=0;z=e.join(d.val.argDelim);try{a=z?E.run(z,d.val.runStyle,!0):d.val.defReturn}catch(G){a=d.val.defReturn}x.quit(a)}})})(WSH,env);env.init();
