/* 1.3.11 определяет дополнительные переменные среды

cscript env.min.js [\\<context>] [<input>@<charset>] [<output>] [<option>...] ...

<context>   - В контексте какого компьютера получить переменные.
<input>     - Формат текстовых данных стандартного потока ввода.
    ini     - Ввести дополнительные переменные в ini формате.
    csv     - Ввести в csv формате (заглавное написание ожидает ещё и заголовок).
    tsv     - Ввести в tsv формате (заглавное написание ожидает ещё и заголовок).
<output>    - Формат текстовых данных стандартного потока вывода.
    ini     - Вывести дополнительные переменные в ini формате.
    csv     - Вывести в csv формате (заглавное написание добавляет заголовок).
    tsv     - Вывести в tsv формате (заглавное написание добавляет заголовок).
<charset>   - Кодировка текста стандартного потока ввода.
<option>    - Дополнительные опции (может быть несколько, порядок не важен).
    silent  - Последующие команды выполнить без отображения.
    nowait  - Последующие команды выполнить без ожидания.
    debug   - Ввести в стандартный поток ошибок отладочную информацию.

*/

// 0.3.16 конструктор основного приложения
function App(a){this.val=a};

// 0.3.3 библиотека функций общего назначения
(function(r,D){r.lib={strFirstUpperCase:function(a){return a.substr(0,1).toUpperCase()+a.substr(1)},clone:function(a){switch(!0){case r.lib.validate(a,"date"):var b=new Date(a);break;case r.lib.validate(a,"array"):b=[];for(var c=0,e=a.length;c<e;c++)b[c]=r.lib.clone(a[c]);break;case r.lib.validate(a,"object"):b={};for(c in a)b[c]="prototype"!==c?r.lib.clone(a[c]):a[c];break;default:b=a}return b},compare:function(a,b,c){var e=0;b||(b=null);switch(!0){case r.lib.validate(a,"string"):b=r.lib.convert(b,
"string");c&&(a=a.toLowerCase(),b=b.toLowerCase());break;case r.lib.validate(a,"array"):b=b&&b.length?b.length:0;a=a.length;break;case r.lib.validate(a,"date"):b=b&&b.valueOf()?b.valueOf():0,a=a.valueOf()}a>b&&(e=1);a<b&&(e=-1);return e},difference:function(a,b,c){var e;c||(c=r.lib.compare);if(r.lib.validate(a,"array")){b||(b=[]);for(var d=0,g=a.length;d<g;d++){var m=a[d];for(var f=0,h=b.length;f<h;f++){var n=b[f];if(value=c(m,n))e||(e=[]),e.push(m)}}}else if(r.lib.validate(a,"object"))for(d in b||
(b={}),a)m=a[d],n=b[d],value=r.lib.difference(m,n,c),r.lib.validate(value,"undefined")||(e||(e={}),e[d]=value);else(value=r.lib.compare(a,b))&&(e=a);return e},strim:function(a,b,c,e,d){var g="";a=a?a.toString():g;b=b?b.toString():g;c=c?c.toString():g;if(d){var m=c?a.lastIndexOf(c):a.length;d=b&&~m?a.lastIndexOf(b,m-1):0}else d=b?a.indexOf(b):0,m=c&&~d?a.indexOf(c,d+b.length):a.length;~d&&~m&&(d=e?d:d+b.length,m=e?m+c.length:m,g=a.substr(d,m-d));return g},trim:function(a){return(a||"").replace(/^\s+|\s+$/g,
"")},validate:function(a,b){var c;switch(b){case "email":b="^([a-z0-9_-]+.)*[a-z0-9_-]+@[a-z0-9_-]+(.[a-z0-9_-]+)*.[a-z]{2,6}$";break;case "password":b="(?=^.{8,}$)((?=.*d)|(?=.*W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$";break;case "guid":b="^{[0-9a-fA-F]{8}(-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}}$";break;case "md5":b="^[0-9a-fA-F]{32}$"}switch(b){case "boolean":a=!0===a||!1===a;break;case "string":a="[object String]"===Object.prototype.toString.call(a);break;case "number":a="[object Number]"===Object.prototype.toString.call(a);
break;case "function":a="[object Function]"===Object.prototype.toString.call(a);break;case "form":a=!(!a||!a.tagName||"form"!==a.tagName.toLowerCase());break;case "files":a="[object FileList]"===Object.prototype.toString.call(a);break;case "date":a="[object Date]"===Object.prototype.toString.call(a);break;case "array":a=Array.isArray?Array.isArray(a):"[object Array]"===Object.prototype.toString.call(a);break;case "xml":a=!(!a||!(c=(a.ownerDocument||a).documentElement)||"html"===c.nodeName.toLowerCase());
break;case "undefined":a=void 0===a;break;case "null":a=null===a;break;case "object":a=a===Object(a)&&"[object Null]"!==Object.prototype.toString.call(a)&&"[object Date]"!==Object.prototype.toString.call(a)&&"[object Function]"!==Object.prototype.toString.call(a)&&"[object FileList]"!==Object.prototype.toString.call(a)&&"[object Array]"!==Object.prototype.toString.call(a)&&!(a&&(c=(a.ownerDocument||a).documentElement)&&"html"!==c.nodeName.toLowerCase())&&!(a&&a.tagName&&"form"===a.tagName.toLowerCase());
break;default:a=(new RegExp(b)).test(""+a)}return a},obj2str:function(a,b,c,e,d){var g=[];c||(c="&");e||(e="=");d||(d=",");for(var m in a){var f=a[m];var h=b?encodeURIComponent(m):m;switch(!0){case r.lib.validate(f,"array"):f=f.join(d);case !r.lib.validate(f,"undefined"):h+=e,h+=b?encodeURIComponent(f):f}g.push(h)}return g.join(c)},str2obj:function(a,b,c,e){var d,g={};c||(c="&");e||(e="=");c=a.split(c);for(var m=0,f=c.length;m<f;m++)if(d=c[m])d=d.split(e,2),a=d[0],d=d[1],a=b?decodeURIComponent(a):
a,d=b&&d?decodeURIComponent(d):d,g[a]=d;return g},url2obj:function(a){var b=a,c={},e=!1;a="fragment";var d="#";-1!=b.indexOf(d)&&(c[a]=r.lib.strim(b,d,null,!1),b=r.lib.strim(b,null,d,!1));a="query";d="?";-1!=b.indexOf(d)&&(c[a]=r.lib.strim(b,d,null,!1),b=r.lib.strim(b,null,d,!1));a="scheme";d="//";0==b.indexOf(d)&&(c[a]=r.lib.strim(b,null,d,!1),b=r.lib.strim(b,d,null,!1),e=!0);a="path";d="/";b.indexOf("://")>b.indexOf(d)&&(c[a]=r.lib.strim(b,d,null,!0),b=r.lib.strim(b,null,d,!1));a="path";d="://";
0==b.indexOf(d)&&(c[a]=r.lib.strim(b,d,null,!0),b=r.lib.strim(b,null,d,!1));a="scheme";d="://";!e&&0<b.indexOf(d)&&(c[a]=r.lib.strim(b,null,d,!1),b=r.lib.strim(b,d,null,!1),e=!0);a="path";d="/";e&&-1!=b.indexOf(d)&&(c[a]=r.lib.strim(b,d,null,!0),b=r.lib.strim(b,null,d,!1));a="path";d=b.length;!e&&0<d&&(c[a]=b,b="");d="@";if(-1!=b.indexOf(d)){var g=r.lib.strim(b,d,null,!1);b=r.lib.strim(b,null,d,!1);a="password";d=":";-1!=b.indexOf(d)&&(c[a]=r.lib.strim(b,d,null,!1),b=r.lib.strim(b,null,d,!1));c.user=
b;b=g}a="port";d=":";-1!=b.indexOf(d)&&(c[a]=r.lib.strim(b,d,null,!1),b=r.lib.strim(b,null,d,!1));e&&(c.domain=b);return c},obj2url:function(a){var b="";"user"in a&&(b="//");"password"in a&&(b="//");"domain"in a&&(b="//");"port"in a&&(b="//");var c="scheme";a[c]&&(b="://");var e=""+((a[c]?a[c]:"")+b);c="user";c in a&&(e+=""+a[c]);c="password";c in a&&(e+=":"+a[c]);b="";"user"in a&&(b="@");"password"in a&&(b="@");c="domain";e+=b+(a[c]?a[c]:"");c="port";c in a&&(e+=":"+a[c]);c="path";c in a&&(e+=""+
a[c]);c="query";c in a&&(e+="?"+a[c]);c="fragment";c in a&&(e+="#"+a[c]);return e},obj2arr:function(a,b){var c=[];switch(!0){case r.lib.validate(b,"string"):case r.lib.validate(b,"number"):var e=b;b=function(m){m||(m={});return m[e]}}for(var d in a){var g=a[d];g=b?b(g,d,a):g;r.lib.validate(g,"undefined")||c.push(g)}return c},arr2obj:function(a,b,c){var e={};switch(!0){case r.lib.validate(b,"string"):case r.lib.validate(b,"number"):var d=b;b=function(p){p||(p={});return p[d]}}switch(!0){case r.lib.validate(c,
"string"):case r.lib.validate(c,"number"):var g=c;c=function(p){p||(p={});return p[g]}}for(var m=0,f=a.length;m<f;m++){var h=a[m];var n=c?c(h,m,a):m;h=b?b(h,m,a):h;r.lib.validate(h,"undefined")||r.lib.validate(n,"undefined")||(e[n]=h)}return e},convert:function(a,b){switch(b){case "bool":case "boolean":a="true"===a?!0:"false"===a?!1:!!a;break;case "int":case "integer":case "float":case "double":case "real":case "number":a=Number(a);break;case "date":a=new Date(1E3*Number(a));break;case "string":r.lib.validate(a,
"boolean")?a=a?"true":"false":r.lib.validate(a,"date")?(a=a.valueOf()/1E3,a=a.toString()):a=r.lib.validate(a,"number")?a.toString():a&&a.toString?a.toString():"";break;case "auto":r.lib.validate(a,"string")&&(b=a.split('"'),3!=b.length||b[0]||b[2]||(a=b[1]),b=a.split("'"),3!=b.length||b[0]||b[2]||(a=b[1]),r.lib.compare("true",a,!0)?r.lib.compare("false",a,!0)?r.lib.compare("null",a,!0)?a.length&&!isNaN(a)&&(a=Number(a)):a=null:a=!1:a=!0)}return a},xhr:function(a,b,c,e,d,g,m,f){var h,n=6E5,p=0;var k=
h={responseText:""};var w=null;if(!p){var q=a?""+a:"get";a=q.toUpperCase();switch(a.toLowerCase()){case "get":w=!0;break;case "head":w=!0;break;case "delete":w=!0}}if(!p){var t=function(){};var v={upload:t,download:t,success:t,error:t,complete:t};if(r.lib.validate(g,"function"))v.complete=g;else if(g)for(u in v)t=g[u],r.lib.validate(t,"function")&&(v[u]=t);g=v}if(!p){v={"X-Requested-With":"XMLHttpRequest"};if(!1===c){var u="X-Requested-With";u in v&&delete v[u]}if(r.lib.validate(c,"object"))for(u in c)switch(t=
c[u],u.toLowerCase()){case "cookie":break;case "host":break;default:v[u]=t}c=v}if(!p){e=e?e:"";if(r.lib.validate(e,"form")){v={};for(var x=0,y=e.elements.length;x<y;x++)t=e.elements[x],t.name&&!t.disabled&&(u=(""+t.type).toLowerCase(),"checkbox"==u||"radio"==u?t.checked&&(v[t.name]=t.value?t.value:!0):v[t.name]=t.files&&t.files.length?t.files:t.value?t.value:D);e=v}r.lib.validate(e,"xml")&&(w=!1,c["Content-Type"]="application/xml",e.xml?e=e.xml:(v=new XMLSerializer,e=v.serializeToString(e)));if(r.lib.validate(e,
"object")){v=!1;for(u in e)if(t=e[u],r.lib.validate(t,"files")){w=!1;v=!0;break}if(v)for(u in v=new FormData,e)if(t=e[u],r.lib.validate(t,"files")){var z=e[u];x=0;for(y=z.length;x<y;x++)t=z[x],v.append(u,t)}else r.lib.validate(t,"undefined")&&(t=""),v.append(u,t);else e=r.lib.obj2str(e,!0),!w&&e&&(c["Content-Type"]="application/x-www-form-urlencoded")}}p||(q=b?""+b:"",w&&e&&(q=q?~q.indexOf("?")?q+"&":q+"?":q+"?",q+=e,e=""),b=q);if(!p){v=null;if(!v)try{v=new XMLHttpRequest}catch(A){}if(!v)for(w="$#!&%",
z=["Ms$#!&%xm$#!&%l2$#!&%.XM$#!&%LHT$#!&%TP.6.0","Ms$#!&%xm$#!&%l2$#!&%.XM$#!&%LHT$#!&%TP.3.0","Ms$#!&%xm$#!&%l2$#!&%.XM$#!&%LHT$#!&%TP","Micr$#!&%osoft$#!&%.XM$#!&%LH$#!&%TTP"],x=0,y=z.length;!v&&x<y;x++){t=z[x];q=t.split(w).join("");try{v=new ActiveXObject(q)}catch(A){}}v?k=v:p=1}if(!p){try{n=setTimeout(function(){q=k.responseText?k.responseText:"";k.abort();g.error(q,k);g.complete(q,k)},n)}catch(A){}k.upload&&(k.upload.onprogress=function(A){A.total&&A.loaded!=A.total&&g.upload(A,k)},k.onprogress=
function(A){A.total&&A.loaded!=A.total&&g.download(A,k)});k.onreadystatechange=function(A){if(4==k.readyState){try{clearTimeout(n)}catch(B){}u=k.status?k.status:200;q=k.responseText?k.responseText:"";200<=u&&300>u&&q?g.success(q,k):g.error(q,k);g.complete(q,k)}}}if(!p)try{f?k.open(a,b,d,m,f):m?k.open(a,b,d,m):k.open(a,b,d)}catch(A){k=h,p=2}if(!p)for(u in c)q=c[u],w="; ",r.lib.validate(q,"array")&&(z=q,q=z.join(w)),k.setRequestHeader(u,q);if(!p)try{e?k.send(e):k.send()}catch(A){k=h,p=3}if(1<p)try{clearTimeout(n)}catch(A){}p&&
(q="",g.error(q,k),g.complete(q,k));return k},ajax:function(a,b,c,e,d){return r.lib.xhr(a,b,c,e,!0,d)},sjax:function(a,b,c,e){return r.lib.xhr(a,b,c,e,!1)},strPad:function(a,b,c,e){var d,g=d="",m=function(f,h){for(;g.length<h;)g+=f;return g=g.substr(0,h)};a=""+a;c=c?""+c:" ";"left"!=e&&"right"!=e&&"both"!=e&&(e="right");0<(d=b-a.length)&&("left"==e?a=m(c,d)+a:"right"==e?a+=m(c,d):"both"==e&&(d=m(c,Math.ceil(d/2)),a=(d+a+a).substr(0,b)));return a},getCookie:function(a,b){var c=document.cookie.indexOf(a+
"="),e=c+a.length+1;if(!c&&a!=document.cookie.substring(0,a.length)||-1==c)return null;a=document.cookie.indexOf(";",e);-1==a&&(a=document.cookie.length);return b?decodeURIComponent(document.cookie.substring(e,a)):unescape(document.cookie.substring(e,a))},setCookie:function(a,b,c,e,d,g,m){var f=new Date((new Date).valueOf()+c);document.cookie=a+"="+(m?encodeURIComponent(b):escape(b))+(c?";expires="+f.toGMTString():"")+(e?";path="+e:"")+(d?";domain="+d:"")+(g?";secure":"");return!0},delCookie:function(a,
b,c){r.lib.getCookie(a)&&(document.cookie=a+"="+(b?";path="+b:"")+(c?";domain="+c:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT");return!0},getStorage:function(a,b){var c,e=null,d=null;if(c=window&&window.localStorage?localStorage.getItem(a):r.lib.getCookie(a)){var g=c.indexOf("?");-1!=g&&(type=c.substr(0,g),c=c.substr(g+1));b?(c=c.split("&"),!0!==b&&(c.length=Math.min(b,c.length))):c=[c];for(var m=0,f=c.length;m<f;m++){g=c[m].indexOf("=");if(-1!=g){if(a=c[m].substr(0,g),a=decodeURIComponent(a),e=c[m].substr(g+
1),!d){var h=!0;d={}}}else a=m,e=c[m],d||(h=!1,d=[]);e=decodeURIComponent(e);type&&(e=r.lib.convert(e,type));h?d[a]=e:d.push(e)}}else d=null;return b?d:e},setStorage:function(a,b){var c,e=[];var d=function(h,n){c||(c=r.lib.validate(h,"number")?"number":r.lib.validate(h,"date")?"date":r.lib.validate(h,"boolean")?"boolean":"string");h=r.lib.convert(h,"string");h=encodeURIComponent(h);r.lib.validate(n,"undefined")?e.push(h):(n=encodeURIComponent(n),e.push(n+"="+h))};if(r.lib.validate(b,"object"))for(var g in b)d(b[g],
g);else if(r.lib.validate(b,"array")){g=0;for(var m=b.length;g<m;g++)d(b[g])}else r.lib.validate(b,"null")||d(b);if(e=e.join("&"))if(e=c+"?"+e,window&&window.localStorage)try{localStorage.setItem(a,e);var f=!0}catch(h){f=!1}else f=r.lib.setCookie(a,e,31536E7,location.pathname,document.domain);else window&&window.localStorage?(localStorage.removeItem(a),f=!0):f=r.lib.delCookie(a,location.pathname,document.domain);return f},counter:function(){var a={};return function(b,c){var e=0;r.lib.validate(b,"array")&&
b.join("_");b&&(a[b]=a[b]||0,e=a[b],!1===c?delete a[b]:!0===c?a[b]++:c&&(a[b]+=c));return e}}(),on:function(){var a={};return function(b,c,e){var d,g=[],m=0;b=b.toString().split(/\s+/);for(var f=0,h=b.length;f<h;f++)if(d=b[f])if(a[d]||(a[d]=[0]),e)if(c){a[d][c]||(a[d][c]=[]);var n=a[d][c].length;a[d][c][n]=e;a[d][0]>=c&&g.push([d,c,n]);m++}else{n=1;for(var p=a[d].length;n<p;n++)if(a[d][n])for(var k=0,w=a[d][n].length;k<w;k++)a[d][n][k]===e&&(delete a[d][n][k],m++)}else if(a[d][0]++,c=c||a[d][0],a[d][c])for(n=
0;n<a[d][c].length;n++)a[d][c][n]&&g.push([d,c,n]),m++;f=0;for(h=g.length;f<h;f++)d=g[f][0],c=g[f][1],n=g[f][2],a[d]&&a[d][c]&&a[d][c][n]&&a[d][c][n].call(a[d][c][n],c);return m}}(),href:function(a){var b=document.createElement("a");b.href=a;return b.cloneNode(!1).href},getExt:function(a){var b="";var c=(""+a).lastIndexOf(".");-1!==c&&(b=a.substr(c+1),b=b.toLowerCase());return b},md5:function(a){var b=function(u,x){var y=u&2147483648;var z=x&2147483648;var A=u&1073741824;var B=x&1073741824;u=(u&1073741823)+
(x&1073741823);return A&B?u^2147483648^y^z:A|B?u&1073741824?u^3221225472^y^z:u^1073741824^y^z:u^y^z},c=function(u,x,y,z,A,B,C){u=b(u,b(b(x&y|~x&z,A),C));return b(u<<B|u>>>32-B,x)},e=function(u,x,y,z,A,B,C){u=b(u,b(b(x&z|y&~z,A),C));return b(u<<B|u>>>32-B,x)},d=function(u,x,y,z,A,B,C){u=b(u,b(b(x^y^z,A),C));return b(u<<B|u>>>32-B,x)},g=function(u,x,y,z,A,B,C){u=b(u,b(b(y^(x|~z),A),C));return b(u<<B|u>>>32-B,x)},m=function(u){var x="",y;for(y=0;3>=y;y++){var z=u>>>8*y&255;z="0"+z.toString(16);x+=z.substr(z.length-
2,2)}return x},f=[];a=function(u){u=u.replace(/\r\n/g,"\n");for(var x="",y=0;y<u.length;y++){var z=u.charCodeAt(y);128>z?x+=String.fromCharCode(z):(127<z&&2048>z?x+=String.fromCharCode(z>>6|192):(x+=String.fromCharCode(z>>12|224),x+=String.fromCharCode(z>>6&63|128)),x+=String.fromCharCode(z&63|128))}return x}(a.toString());f=function(u){var x=u.length;var y=x+8;for(var z=16*((y-y%64)/64+1),A=Array(z-1),B,C=0;C<x;)y=(C-C%4)/4,B=C%4*8,A[y]|=u.charCodeAt(C)<<B,C++;y=(C-C%4)/4;A[y]|=128<<C%4*8;A[z-2]=
x<<3;A[z-1]=x>>>29;return A}(a);var h=1732584193;var n=4023233417;var p=2562383102;var k=271733878;for(a=0;a<f.length;a+=16){var w=h;var q=n;var t=p;var v=k;h=c(h,n,p,k,f[a+0],7,3614090360);k=c(k,h,n,p,f[a+1],12,3905402710);p=c(p,k,h,n,f[a+2],17,606105819);n=c(n,p,k,h,f[a+3],22,3250441966);h=c(h,n,p,k,f[a+4],7,4118548399);k=c(k,h,n,p,f[a+5],12,1200080426);p=c(p,k,h,n,f[a+6],17,2821735955);n=c(n,p,k,h,f[a+7],22,4249261313);h=c(h,n,p,k,f[a+8],7,1770035416);k=c(k,h,n,p,f[a+9],12,2336552879);p=c(p,k,
h,n,f[a+10],17,4294925233);n=c(n,p,k,h,f[a+11],22,2304563134);h=c(h,n,p,k,f[a+12],7,1804603682);k=c(k,h,n,p,f[a+13],12,4254626195);p=c(p,k,h,n,f[a+14],17,2792965006);n=c(n,p,k,h,f[a+15],22,1236535329);h=e(h,n,p,k,f[a+1],5,4129170786);k=e(k,h,n,p,f[a+6],9,3225465664);p=e(p,k,h,n,f[a+11],14,643717713);n=e(n,p,k,h,f[a+0],20,3921069994);h=e(h,n,p,k,f[a+5],5,3593408605);k=e(k,h,n,p,f[a+10],9,38016083);p=e(p,k,h,n,f[a+15],14,3634488961);n=e(n,p,k,h,f[a+4],20,3889429448);h=e(h,n,p,k,f[a+9],5,568446438);
k=e(k,h,n,p,f[a+14],9,3275163606);p=e(p,k,h,n,f[a+3],14,4107603335);n=e(n,p,k,h,f[a+8],20,1163531501);h=e(h,n,p,k,f[a+13],5,2850285829);k=e(k,h,n,p,f[a+2],9,4243563512);p=e(p,k,h,n,f[a+7],14,1735328473);n=e(n,p,k,h,f[a+12],20,2368359562);h=d(h,n,p,k,f[a+5],4,4294588738);k=d(k,h,n,p,f[a+8],11,2272392833);p=d(p,k,h,n,f[a+11],16,1839030562);n=d(n,p,k,h,f[a+14],23,4259657740);h=d(h,n,p,k,f[a+1],4,2763975236);k=d(k,h,n,p,f[a+4],11,1272893353);p=d(p,k,h,n,f[a+7],16,4139469664);n=d(n,p,k,h,f[a+10],23,3200236656);
h=d(h,n,p,k,f[a+13],4,681279174);k=d(k,h,n,p,f[a+0],11,3936430074);p=d(p,k,h,n,f[a+3],16,3572445317);n=d(n,p,k,h,f[a+6],23,76029189);h=d(h,n,p,k,f[a+9],4,3654602809);k=d(k,h,n,p,f[a+12],11,3873151461);p=d(p,k,h,n,f[a+15],16,530742520);n=d(n,p,k,h,f[a+2],23,3299628645);h=g(h,n,p,k,f[a+0],6,4096336452);k=g(k,h,n,p,f[a+7],10,1126891415);p=g(p,k,h,n,f[a+14],15,2878612391);n=g(n,p,k,h,f[a+5],21,4237533241);h=g(h,n,p,k,f[a+12],6,1700485571);k=g(k,h,n,p,f[a+3],10,2399980690);p=g(p,k,h,n,f[a+10],15,4293915773);
n=g(n,p,k,h,f[a+1],21,2240044497);h=g(h,n,p,k,f[a+8],6,1873313359);k=g(k,h,n,p,f[a+15],10,4264355552);p=g(p,k,h,n,f[a+6],15,2734768916);n=g(n,p,k,h,f[a+13],21,1309151649);h=g(h,n,p,k,f[a+4],6,4149444226);k=g(k,h,n,p,f[a+11],10,3174756917);p=g(p,k,h,n,f[a+2],15,718787259);n=g(n,p,k,h,f[a+9],21,3951481745);h=b(h,w);n=b(n,q);p=b(p,t);k=b(k,v)}return(m(h)+m(n)+m(p)+m(k)).toLowerCase()},sha256:function(a){var b=function(e,d){var g=(e&65535)+(d&65535);return(e>>16)+(d>>16)+(g>>16)<<16|g&65535},c=function(e,
d){return e>>>d|e<<32-d};a=function(e){e=e.replace(/\r\n/g,"\n");for(var d="",g=0;g<e.length;g++){var m=e.charCodeAt(g);128>m?d+=String.fromCharCode(m):(127<m&&2048>m?d+=String.fromCharCode(m>>6|192):(d+=String.fromCharCode(m>>12|224),d+=String.fromCharCode(m>>6&63|128)),d+=String.fromCharCode(m&63|128))}return d}(a);return function(e){for(var d="",g=0;g<4*e.length;g++)d+="0123456789abcdef".charAt(e[g>>2]>>8*(3-g%4)+4&15)+"0123456789abcdef".charAt(e[g>>2]>>8*(3-g%4)&15);return d}(function(e,d){var g=
[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,
275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],m=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],f=Array(64),h,n;e[d>>5]|=128<<24-d%32;e[(d+64>>9<<4)+15]=d;for(h=0;h<e.length;h+=16){d=m[0];var p=m[1];var k=m[2];var w=m[3];var q=m[4];var t=m[5];var v=m[6];var u=m[7];for(n=0;64>n;n++){if(16>n)f[n]=e[n+h];else{var x=n;var y=f[n-
2];y=c(y,17)^c(y,19)^y>>>10;y=b(y,f[n-7]);var z=f[n-15];z=c(z,7)^c(z,18)^z>>>3;f[x]=b(b(y,z),f[n-16])}x=q;x=c(x,6)^c(x,11)^c(x,25);x=b(b(b(b(u,x),q&t^~q&v),g[n]),f[n]);u=d;u=c(u,2)^c(u,13)^c(u,22);y=b(u,d&p^d&k^p&k);u=v;v=t;t=q;q=b(w,x);w=k;k=p;p=d;d=b(x,y)}m[0]=b(d,m[0]);m[1]=b(p,m[1]);m[2]=b(k,m[2]);m[3]=b(w,m[3]);m[4]=b(q,m[4]);m[5]=b(t,m[5]);m[6]=b(v,m[6]);m[7]=b(u,m[7])}return m}(function(e){for(var d=[],g=0;g<8*e.length;g+=8)d[g>>5]|=(e.charCodeAt(g/8)&255)<<24-g%32;return d}(a),8*a.length))},
parseJSON:function(a){if(window&&window.JSON&&JSON.parse)try{var b=JSON.parse(a)}catch(c){b=eval("("+a+")")}else b=eval("("+a+")");return b},numDeclin:function(a,b,c,e){a=Number(a);a=Math.abs(a);a=Math.floor(a);var d=a%10;return 1!=(a%100-d)/10?0==d?b:1==d?c:5>d?e:b:b},num2str:function(a,b,c,e){var d,g;isNaN(b=Math.abs(b))&&(b=2);c==D&&(c=",");e==D&&(e=".");if(g=0>a)a=Math.abs(a);var m=parseInt(a=(+a||0).toFixed(b))+"";var f=(d=3<(d=m.length)?d%3:0)?m.substr(0,d)+e:"";e=m.substr(d).replace(/(\d{3})(?=\d)/g,
"$1"+e);a=b?c+Math.abs(a-m).toFixed(b).replace(/-/,0).slice(2):"";return(g?"-":"")+f+e+a},num2word:function(a,b,c){function e(u,x){u=u.toString().substr(-2);return x[0]+(/^[0,2-9]?[1]$/.test(u)?x[2]:/^[0,2-9]?[2-4]$/.test(u)?x[3]:x[1])}var d=[],g=[["ноль"],[,,,"три","четыре","пять","шесть","семь","восемь","девять"],"десять одиннадцать двенадцать тринадцать четырнадцать пятнадцать шестнадцать семнадцать восемнадцать девятнадцать".split(" "),[,,"двадцать","тридцать","сорок","пятьдесят","шестьдесят",
"семьдесят","восемьдесят","девяносто"],[,"сто","двести","триста","четыреста","пятьсот","шестьсот","семьсот","восемьсот","девятьсот"],[[,"один","два"],[,"одна","две"],[,"одно","два"]]],m=[["...ллион","ов","","а"],["тысяч","","а","и"],["миллион","ов","","а"],["миллиард","ов","","а"],["триллион","ов","","а"],["квадриллион","ов","","а"],["квинтиллион","ов","","а"],["секстилион","ов","","а"],["септилион","ов","","а"],["окталион","ов","","а"],["ноналион","ов","","а"],["декалион","ов","","а"],["эндекалион",
"ов","","а"],["додекалион","ов","","а"]],f=[[["цел","ых","ый","ых"],["цел","ых","ая","ых"],["цел","ых","ое","ых"]],["десят","ых","ая","ых"],["сот","ых","ая","ых"],["тясячн","ых","ая","ых"],["десятитысячн","ых","ая","ых"],["стотысячн","ых","ая","ых"],["милионн","ых","ая","ых"],["десятимилионн","ых","ая","ых"]];c=c||0;a=a.toString().split(".");for(var h=0,n=a.length;h<n;h++){h&&(a[h]=a[h].substr(0,f.length-1));l=a[h].length;a[h]=["","00","0"][a[h].split(/\d{3}/).join("").length]+a[h];for(var p=a[h].length,
k,w=0,q=-1,t=[];3*w<p;){k=a[h].substr(-3*(w+1),3);t[++q]=[];for(var v=0;2>=v;v++)if(0!=k[v])switch(v){case 0:t[q][t[q].length]=g[4][k[v]];break;case 1:1==k[v]?(t[q][t[q].length]=g[2][k[2]],v=3):t[q][t[q].length]=g[3][k[v]];break;case 2:t[q][t[q].length]=2>=k[v]?g[5][1==w||h?1:c][k[v]]:g[1][k[v]]}t[q].length||(t[q][t[q].length]=g[0][0]);0<k&&0<w&&(t[q][t[q].length]=e(k,m[w]));!w&&1<n&&(t[q][t[q].length]=e(k,h?f[l]:f[0][c]));w||!b||h||h!=n-1?!w&&b&&h&&(t[q][t[q].length]=b[0]+b[3]):t[q][t[q].length]=
e(k,b);t[q]=t[q].join(" ");w++}d[d.length]=t.reverse().join(" ")}return d.join(" ")},date2str:function(a,b){var c="Воскресенье Понедельник Вторник Среда Четверг Пятница Суббота".split(" "),e=" Января Февраля Марта Апреля Мая Июня Июля Августа Сентября Октября Ноября Декабря".split(" "),d={0:"ый",2:"ой",3:"ий",6:"ой",7:"ой",8:"ой",22:"ой",26:"ой",27:"ой",28:"ой"},g={"-660":"ST","-600":"HAST","-540":"AKT","-480":"AWST","-420":"CXT","-360":"СST","-300":"EST","-240":"AST","-210":"NST","-180":"ART",0:"GMT",
60:"CET",120:"CAT",180:"MSK",210:"IRST",300:"PKT",330:"IST",360:"BDT",390:"MST",420:"CXT",480:"AWST",540:"JST",570:"ACST",600:"AEST",660:"NFT"},m="";var f=function(w){var q="";switch(w){case "d":q+=r.lib.strPad(f("j"),2,"0","left");break;case "D":q+=f("l").substr(0,3);break;case "j":q+=a.getDate();break;case "l":q+=c[f("w")];break;case "N":q+=f("w")||7;break;case "S":q+=d[f("j")]||d[0];break;case "w":q+=a.getDay();break;case "z":q+=(a-new Date(a.getFullYear(),0,1))/864E5>>0;break;case "W":w=new Date(a.valueOf());
var t=(a.getDay()+6)%7;w.setDate(w.getDate()-t+3);t=w.valueOf();w.setMonth(0,1);4!==w.getDay()&&w.setMonth(0,1+(4-w.getDay()+7)%7);q+=1+Math.ceil((t-w)/6048E5);break;case "F":q+=e[f("n")];break;case "m":q+=r.lib.strPad(f("n"),2,"0","left");break;case "M":q+=f("F").substr(0,3);break;case "n":q+=a.getMonth()+1;break;case "t":q+=(new Date(a.getFullYear(),a.getMonth()+1,0)).getDate();break;case "L":q+=a.getFullYear()&3||!(a.getFullYear()%100)&&a.getFullYear()%400?0:1;break;case "o":(function(){var v=
new Date(a.valueOf());v.setDate(v.getDate()-(a.getDay()+6)%7+3);q+=v.getFullYear()})();break;case "Y":q+=a.getFullYear();break;case "y":q+=f("Y").substr(2,2);break;case "a":q+=11<a.getHours()?"pm":"am";break;case "A":q+=f("a").toUpperCase();break;case "B":(function(){var v=60*(a.getTimezoneOffset()+60);v=3600*a.getHours()+60*a.getMinutes()+a.getSeconds()+v;v=Math.floor(v/86.4);1E3<v&&(v-=1E3);0>v&&(v+=1E3);q+=r.lib.strPad(v,3,"0","left")})();break;case "g":q+=a.getHours()%12||12;break;case "G":q+=
a.getHours();break;case "h":q+=r.lib.strPad(f("g"),2,"0","left");break;case "H":q+=r.lib.strPad(f("G"),2,"0","left");break;case "i":q+=r.lib.strPad(a.getMinutes(),2,"0","left");break;case "s":q+=r.lib.strPad(a.getSeconds(),2,"0","left");break;case "u":q+=r.lib.strPad(1E3*a.getMilliseconds(),6,"0","left");break;case "e":q+=(new Date).toString().split(" ")[5].split("-")[0].split("+")[0];break;case "I":q+=(new Date(a.getFullYear(),0,1)).getTimezoneOffset()!=a.getTimezoneOffset()?1:0;break;case "O":q+=
(0<a.getTimezoneOffset()?"-":"+")+r.lib.strPad(Math.abs(a.getTimezoneOffset()/60*100),4,"0","left");break;case "P":q+=f("O").substr(0,3)+":"+f("O").substr(3,2);break;case "T":q+=g[-1*a.getTimezoneOffset()-60*Number(f("I"))]||g[0];break;case "Z":q+=-60*a.getTimezoneOffset();break;case "c":q+=f("Y")+"-"+f("m")+"-"+f("d")+"T"+f("h")+":"+f("i")+":"+f("s")+f("P");break;case "r":q+=f("D")+", "+f("j")+" "+f("M")+" "+f("Y")+" "+f("h")+":"+f("i")+":"+f("s")+" "+f("O");break;case "U":q+=Math.round(a.getTime()/
1E3)}return q};for(var h=0,n=b.length;h<n;h++){var p=b.charAt(h);m="\\"!==k?m+(f(p)||p):m+p;var k=p}return m},extend:function(){var a=arguments[0]||{},b=1,c=arguments.length,e=!1,d;r.lib.validate(a,"boolean")&&(e=a,a=arguments[1]||{},b=2);for(r.lib.validate(a,"object")||r.lib.validate(a,"function")||(a={});b<c;++b)if(null!=(d=arguments[b]))for(var g in d){var m=a[g],f=d[g];a!==f&&(e&&f&&r.lib.validate(f,"object")&&!f.nodeType?a[g]=r.lib.extend(e,m||(null!=f.length?[]:{}),f):r.lib.validate(f,"undefined")||
(a[g]=f))}return a},template:function(a,b,c){var e;if(a){b||(b={});a=a.toString();a=a.split("|");for(var d=a.length,g=d-1;-1<g;g--)if(e=a[g]){var m=!0;var f=e.split("{");for(var h=1,n=f.length;h<n;h++){e=f[h];var p=e.indexOf("}");if(~p){var k=e.substr(0,p);var w=k.split(">");var q=w.shift().split(".");if(r.lib.validate(b,"function"))k=b(q),m=!r.lib.validate(k,"undefined");else{k=b;for(var t=0,v=q.length;m&&t<v;t++){var u=q[t];(m=u in k)&&(k=k[u])}}t=0;for(v=w.length;m&&t<v;t++)m=w[t],c?(k=c(m,k),
m=!r.lib.validate(k,"undefined")):m=!1;m&&(p+=1,e=k+e.substr(p))}else e="{"+e;f[h]=e}e=f.join("");m?a[g]=e:a.splice(g,1)}else g&&g<d-1&&(a[g]="|");b=a.join("")}else b="";return b},getRandomString:function(a,b){var c="";b||(b=89);b=Math.min(Math.max(b,1),89);for(var e=0;e<a;e++)c+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()-_+=;:,./?|`~[]{}".charAt(Math.round(Math.random()*(b-1)));return c},hasValue:function(a,b,c){var e=!1;var d=!c&&r.lib.validate(b,"string");switch(!0){case r.lib.validate(a,
"array"):for(var g=0,m=a.length;g<m&&!(e=c?a[g]===b:d&&r.lib.validate(a[g],"string")?a[g].toLowerCase()==b.toLowerCase():a[g]==b);g++);break;case r.lib.validate(a,"object"):for(g in a)if(e=c?a[g]===b:d&&r.lib.validate(a[g],"string")?a[g].toLowerCase()==b.toLowerCase():a[g]==b)break;break;case r.lib.validate(a,"string"):e=d?-1!=a.toLowerCase().indexOf(b.toLowerCase()):-1!=a.indexOf(b);break;default:e=c?a===b:a==b}return e},ini2obj:function(a,b){var c={};a=a?(""+a).split("\r\n"):"";for(var e=0,d=a.length;e<
d;e++){var g=r.lib.trim(a[e]);if(g.indexOf(";")&&g.indexOf("#"))if(g.indexOf("[")||g.length!=g.indexOf("]",1)+1){if(~g.indexOf("=")){var m=r.lib.trim(r.lib.strim(g,null,"=",!1,!1));g=r.lib.trim(r.lib.strim(g,"=",null,!1,!1));b&&(g=r.lib.convert(g,"auto"))}else m=r.lib.trim(g),g=D;f?(r.lib.validate(c[f],"object")||(c[f]={}),m&&(c[f][m]=g)):m&&(c[m]=g)}else var f=r.lib.trim(g.substr(1,g.length-1-1))}return c},tsv2arr:function(a,b,c,e,d){var g,m=0,f=[],h=[],n="\t",p=[];c&&(n=c);a=(a?""+a:"").split("\r\n");
switch(!0){case r.lib.validate(b,"array"):c=0;for(var k=b.length;c<k;c++){var w=b[c];var q="";f.push(w);h.push(q)}break;case r.lib.validate(b,"object"):for(w in b)q=b[w],f.push(w),h.push(q);break;case !!b:b=a[m].split(n);c=0;for(k=b.length;c<k;c++){var t=b[c].split(":");w=t[0];q=t[1]||"";f.push(w);h.push(q)}m++}for(t=a.length;m<t;m++)if(w=a[m]){b=w.split(n);var v=!1;var u=(g=f.length)?{}:[];w=g?f.length:b.length;c=0;for(k=w;c<k;c++){var x=b[c]||"";w=g?f[c]:u.length;q=h[c]||(e?"auto":"");g&&!w||d&&
!x||(q&&(x=r.lib.convert(x,q)),u[w]=x,v=!0)}v&&p.push(u)}return p},arr2tsv:function(a,b,c,e){var d=0,g,m=!1,f=[],h=[],n=[],p="\t",k="";a||(a=[]);c&&(p=c);switch(!0){case r.lib.validate(b,"array"):c=0;for(var w=b.length;c<w;c++){var q=b[c];h.push(q);m=!0}break;case r.lib.validate(b,"object"):for(q in b){var t=b[q];h.push(q);n.push(t);m=!0}}if(!h.length)for(c=0,w=a.length;c<w;c++)switch(t=a[c],!0){case r.lib.validate(t,"array"):c=0;for(w=t.length;c<w;c++)q=""+c,r.lib.hasValue(h,q,!0)||h.push(q);break;
case r.lib.validate(t,"object"):for(q in t)r.lib.hasValue(h,q,!0)||(h.push(q),m=!0)}if(!n.length&&e)for(c=0,w=h.length;c<w;c++){b=t="";q=h[c];var v=0;for(g=a.length;v<g;v++)if(q in a[v]){b=a[v][q];switch(!0){case r.lib.validate(b,"boolean"):b="boolean";break;case r.lib.validate(b,"number"):b="number";break;case r.lib.validate(b,"date"):b="date";break;default:b=""}if(t&&t!=b)break;else t=b}b||(t="string");n[c]=t}if(h.length&&r.lib.validate(e,"boolean")){v=[];g=!1;c=0;for(w=h.length;c<w;c++)q=h[c],
t=n[c],b=q+(e?":"+t:""),~b.indexOf(p)&&(b=b.split(p).join("")),~b.indexOf("\r\n")&&(b=b.split("\r\n").join("")),b&&(g=!0),v.push(b);v.length&&g&&(q=v.join(p),f.push(q))}for(e=a.length;d<e;d++){t=a[d];v=[];g=!1;q=m?h.length:t.length;c=0;for(w=q;c<w;c++)q=m?h[c]:c,b=q in t?t[q]:"",b=r.lib.convert(b,"string"),~b.indexOf(p)&&(b=b.split(p).join("")),~b.indexOf("\r\n")&&(b=b.split("\r\n").join("")),b&&(g=!0),v.push(b);v.length&&g&&(q=v.join(p),f.push(q))}f.length&&(k=f.join("\r\n"));return k},sort:function(a,
b){var c=[],e=0;if(!r.lib.validate(b,"function")){switch(b){case "asc":case !0:e=1;break;case "desc":case !1:e=-1}b=function(f,h){return e?e*r.lib.compare(f,h,!1):0}}switch(!0){case r.lib.validate(a,"array"):var d=a.sort(b);break;case r.lib.validate(a,"object"):d={};for(m in a)c.push(m);c.sort(b);b=0;for(var g=c.length;b<g;b++){var m=c[b];d[m]=a[m]}break;default:d=a}return d},count:function(a,b){var c=0;if(a)switch(!0){case r.lib.validate(a,"array"):b||(c=a.length);for(var e=c,d=a.length;e<d;e++){var g=
a[e];b&&!g||c++}break;case r.lib.validate(a,"object"):for(e in a)g=a[e],b&&!g||c++}return c},match:function(a,b){var c;a=a?""+a:"";var e=c=!1;b=(b?""+b:"").split("|");for(var d=0,g=b.length;d<g&&!e;d++){b[d]=b[d].split("!");for(var m=0,f=b[d].length;m<f&&!e;m++)e=b[d][m],e=r.lib.trim(e),e=r.lib.hasValue(a,e,!1),c=m?c&&!e:c||e,e=m&&!c}return!!c}}})(App.prototype);

// 0.2.1 функци для работы в среде windows script host
(function(r,u,v){r.wsh={getLDAP:function(b,c,a,d,e){var l=[],q=[],f=0;if(!f){var m=new ActiveXObject("ADODB.Connection");var t=new ActiveXObject("NameTranslate");var h=new ActiveXObject("ADODB.Command")}f||(m.provider="ADsDSOObject",d&&(m.properties("User ID").value=d),e&&(m.properties("Password").value=e),m.open("Active Directory Provider"),h.activeConnection=m,h.properties("Searchscope").value=2,h.properties("Page Size").value=100);if(!f)if(a)var n=a;else try{var g=GetObject("LDAP://RootDSE");n=
g.get("DefaultNamingContext")}catch(p){f=1}f||(q=[b],c&&q.push(c));for(d=q.length-1;!f&&-1<d;d--){b=q[d];c=g=null;e="SELECT distinguishedName FROM 'LDAP://"+n+"'";if(!f&&b&&!c&&r.lib.validate(b,"guid")){a=(""+b).toUpperCase();try{t.init(3,""),t.set(7,a),c=t.get(1)}catch(p){f=2}}if(!f&&b&&!c)try{(c=b.get("distinguishedName"))&&(g=b)}catch(p){}if(!f&&b&&!c){a=e+" WHERE name = '"+b+"' OR sAMAccountName = '"+b+"' OR distinguishedName = '"+b+"'";try{h.commandText=a;var k=h.execute();k.recordCount&&(c=
k.fields("distinguishedName").value)}catch(p){}}if(!f&&!c){b?(a=""+b,a=r.lib.template(a,{protocol:"LDAP:",parent:n,select:e}),a.toUpperCase().indexOf("WHERE")?a.toUpperCase().indexOf("SELECT")&&(f=3):a=e+" "+a):a=e+" WHERE distinguishedName = '"+n+"'";try{h.commandText=a,k=h.execute(),k.recordCount||(f=5)}catch(p){f=4}}if(!f&&c&&!d)if(g)l.push(g);else{a=c;try{g=GetObject("LDAP://"+a),l.push(g)}catch(p){f=6}}if(!f&&!c)for(b=0,e=k.recordCount;b<e;k.moveNext(),b++)a=k.fields("distinguishedName").value,
b||(c=a),!d&&a&&(g=GetObject("LDAP://"+a),l.push(g));f||(n=c)}return l},iconv:function(b,c,a){var d=new ActiveXObject("ADODB.Stream");d.type=2;d.mode=3;d.open();d.charset=c;d.writeText(a);d.position=0;d.charset=b;a=d.readText();d.close();return a},getFileText:function(b){var c="";var a=new ActiveXObject("ADODB.Stream");a.type=2;a.mode=3;a.open();try{a.loadFromFile(b),c=a.readText()}catch(d){}a.close();return c},setFileText:function(b,c,a){var d=0;var e=new ActiveXObject("ADODB.Stream");e.type=2;e.mode=
3;e.open();if(a)try{e.loadFromFile(b),e.readText(),e.writeText("\r\n")}catch(l){}try{e.writeText(c),e.saveToFile(b,2)}catch(l){d=1}e.close();return!d}}})(App.prototype,WSH);

// 0.1.0 расширяем глобальные функции среды
function setEnv(env, key, value) { env(key) = value; }

// 1.3.11 определяет дополнительные переменные среды
var env=new App({driveMinSize:27917287424,runStyle:1,defReturn:0,argWrap:'"',argDelim:" ",linDelim:"\r\n",keyDelim:"\\",chrDelim:"@",getDelim:"+",setDelim:"#",iniDelim:"=",csvDelim:";",tsvDelim:"\t",envType:"Process"});
(function(x,c,F){c.lib.extend(c,{fun:{wql2date:function(g,m){return new Date(g?Date.UTC(1*g.substr(0,4),1*g.substr(4,2)-1,1*g.substr(6,2),1*g.substr(8,2),1*g.substr(10,2)-1*g.substr(21,4)+(m||0),1*g.substr(12,2),1*g.substr(14,3)):0)},getDateOfWeek:function(g,m){var p=new Date;g=1*g||1;m=1*m||p.getFullYear();p=(new Date(m,0,4)).getDay();return new Date(m,0,-((6+p)%7)+7*g)},bin2key:function(g){var m="";try{var p=g.toArray()}catch(w){p=[]}if(p.length){g=Math.floor(p[66]/6)&1;p[66]=p[66]&247|4*(g&2);
for(var l=24;-1<l;l--){var d=0;for(var n=14;-1<n;n--)d*=256,d=p[n+52]+d,p[n+52]=Math.floor(d/24),d%=24;m="BCDFGHJKMPQRTVWXY2346789".substr(d,1)+m}1==g&&(p=m.substr(1,d),m=m.substr(1).replace(p,p+"N"));m=[m.substr(0,5),m.substr(5,5),m.substr(10,5),m.substr(15,5),m.substr(20,5)].join("-")}return m},bin2sid:function(g){var m="";try{var p=g.toArray()}catch(r){p=[]}if(p.length){var l=p[0]&255;g=p[1]&255;var d=0;for(var n=2;7>=n;n++)d+=(p[n]&255)*(1<<8*(5-(n-2)));m=m+("S-"+l)+("-"+d);d=8;for(n=0;n<g;n++){for(var w=
l=0;4>w;w++)l+=(p[d+w]&255)*(1<<8*w);m+="-"+l;d+=4}}return m},bin2str:function(g){var m="";try{var p=g.toArray()}catch(n){p=[]}for(var l=0,d=p.length;l<d;l++)(g=p[l])&&(m+=String.fromCharCode(g));return m},info2str:function(g,m,p){if(!p||2>p)p=1024;if(!m||0>m)m=0;var l=Math.pow(10,m);for(var d=-1;g>=p;d++)g/=p;g=Math.ceil(g*l)/l;g=c.lib.num2str(g,-1<d?m:0,",","");return g+=" "+"КМГТПЭЗЙ".charAt(d)},clear:function(g){g=g?""+g:"";"INVALID"==g&&(g="");"To be filled by O.E.M."==g&&(g="");"System Product Name"==
g&&(g="");"System Serial Number"==g&&(g="");"System manufacturer"==g&&(g="");"Default string"==g&&(g="");"empty"==g&&(g="");"None"==g&&(g="");for(var m=1,p=arguments.length;m<p;m++)g=g.replace(arguments[m],"");return g.replace(/\(R\)/gi,"").replace(/\(Registered Trademark\)/gi,"").replace(/\(Microsoft Corporation\)/gi,"").replace(/\(Корпорация Майкрософт\)/gi,"").replace(/\(Майкрософт\)/gi,"").replace(/\(TM\)/gi,"").replace(/^[/'"]|[/"']$/g,"").replace(/\r\n|\n|\t/g," ").replace(/^\s+|\s+$/g,"").replace(/\.+$/,
"").replace(/\s(?=\s)/gi,"")},repair:function(g){return("'"+(g?g:"")+"'").replace(/\\/g,"\\\\")},debug:function(){var g,m,p={},l=-1;return function(d){if(p.first){g=[c.lib.strPad(l,3,"0","left")];g.push("|");g.push(c.lib.strPad(c.lib.num2str((p.now.valueOf()-p.first.valueOf())/1E3,3,".",""),7,"0","left"));p.last=p.now;p.now=new Date;g.push("+"+c.lib.strPad(c.lib.num2str((p.now.valueOf()-p.last.valueOf())/1E3,3,".",""),7,"0","left"));g.push("|");g.push(m);try{x.stdErr.writeLine(g.join(" "))}catch(n){}}else p.now=
new Date;!l&&m&&(p.first=p.now);m=d;l++;return d}}()},init:function(){var g,m="",p="",l={};var d={};var n={},w=0;var r=new Date;var A=new ActiveXObject("WScript.Shell");var e=new ActiveXObject("wbemScripting.Swbemlocator");e.security_.impersonationLevel=3;var h=x.arguments.length;for(g=0;g<h;g++){var a=x.arguments.item(g);var k="context";if(!(k in n)){var f=a.split(c.val.keyDelim);if(3==f.length&&!f[0]&&!f[1]){n[k]=f[2];continue}}k="input";if(!(k in n)&&(f=a.split(c.val.chrDelim),2==f.length&&c.lib.hasValue(["ini",
"csv","tsv","CSV","TSV"],f[0],!0)&&f[1])){n[k]=f[0];n.charset=f[1];continue}k="output";if(!(k in n)&&(f=a.split(c.val.chrDelim),1==f.length&&c.lib.hasValue(["ini","csv","tsv","CSV","TSV"],f[0],!0))){n[k]=f[0];continue}k="silent";if(k in n||c.lib.compare(k,a,!0))if(k="nowait",k in n||c.lib.compare(k,a,!0))if(k="debug",k in n||c.lib.compare(k,a,!0))break;else n[k]=!0;else n[k]=!0;else n[k]=!0}var B=g;"context"in n||(n.context=".");"auto"==n.charset&&(n.charset="windows-1251");c.fun.debug(n.debug);if(n.context)for(c.fun.debug("Connect and create objects"),
g=1;g;g++)try{switch(g){case 1:var t=e.connectServer(n.context,"root\\CIMV2",null,null,null,null,128);break;case 2:var z=e.connectServer(n.context,"root\\WMI",null,null,null,null,128);break;case 3:var u=e.connectServer(".","root\\directory\\LDAP",null,null,null,null,128);break;case 4:var C=e.connectServer(n.context,"root\\Microsoft\\Windows\\Storage",null,null,null,null,128);break;case 5:var v=e.connectServer(n.context,"root\\default",null,null,null,null,128).get("stdRegProv");break;default:g=-1}}catch(y){switch(g){case 1:t=
null;g=-1;break;case 2:z=null;break;case 3:u=null;break;case 4:C=null;break;case 5:v=null}}if(t){if(v){e=v.methods_.item("getBinaryValue");var b=e.inParameters.spawnInstance_();b.hDefKey=2147483650;b.sSubKeyName="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion";b.sValueName=c.fun.debug("DigitalProductId");b=v.execMethod_(e.name,b);!b.returnValue&&(a=c.fun.bin2key(b.uValue),a=c.fun.clear(a))&&(d["SYS-KEY"]=a)}g=null;response=t.execQuery(c.fun.debug("SELECT * FROM Win32_OperatingSystem WHERE primary = TRUE"));
for(e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();b.systemDrive&&(g=b);if(a=b.localDateTime)r=c.fun.wql2date(a);if(a=c.fun.clear(b.caption,"Майкрософт","Microsoft","Edition","x64",","))d["SYS-NAME"]=a;if(a=c.fun.clear(b.version))d["SYS-VERSION"]=a;if(a=b.localDateTime)d["SYS-TIME"]=c.lib.date2str(c.fun.wql2date(a),"d.m.Y H:i:s");if(a=b.localDateTime)d["SYS-TIME-DATE"]=c.lib.date2str(c.fun.wql2date(a),"d.m.Y");if(a=c.fun.clear(b.systemDrive))d["SYS-DRIVE"]=a;if(a=b.installDate)d["SYS-INSTALL"]=
c.lib.date2str(c.fun.wql2date(a),"d.m.Y H:i:s");if(a=b.installDate)d["SYS-INSTALL-DATE"]=c.lib.date2str(c.fun.wql2date(a),"d.m.Y");if(a=b.lastBootUpTime)d["SYS-RESET"]=c.lib.date2str(c.fun.wql2date(a),"d.m.Y H:i:s");if(a=b.lastBootUpTime)d["SYS-RESET-DATE"]=c.lib.date2str(c.fun.wql2date(a),"d.m.Y");if(a=c.fun.clear(b.serialNumber))d["SYS-SERIAL"]=a;if(a=c.fun.clear(b.description))d["SYS-DESCRIPTION"]=a;d["SYS-ARCHITECTURE"]=b.osArchitecture&&!b.osArchitecture.indexOf("64")?"x64":"x86";break}response=
t.execQuery(c.fun.debug("SELECT caption, size FROM Win32_LogicalDisk WHERE driveType = 2 OR driveType = 3 OR driveType = 4"));for(e=new Enumerator(response);!e.atEnd();)b=e.item(),e.moveNext(),b.caption&&g&&g.systemDrive&&-1!=b.caption.indexOf(g.systemDrive)||d["BAK-DRIVE"]||(a=c.fun.clear(b.caption))&&b.size>=c.val.driveMinSize&&(d["BAK-DRIVE"]=a);response=t.execQuery(c.fun.debug("SELECT manufacturer, product, serialNumber FROM Win32_BaseBoard WHERE hostingBoard = TRUE"));for(e=new Enumerator(response);!e.atEnd();){b=
e.item();e.moveNext();if(a=c.fun.clear(b.product))d["PCB-NAME"]=a;a&&(a=c.fun.clear(b.manufacturer,"Inc.").replace("Hewlett-Packard","HP"))&&(d["PCB-NAME"]=a.split(" ")[0]+" "+c.fun.clear(b.product));if(a=c.fun.clear(b.serialNumber))d["PCB-SERIAL"]=a;break}response=t.execQuery(c.fun.debug("SELECT releaseDate, manufacturer, smBIOSBIOSVersion, serialNumber FROM Win32_BIOS WHERE primaryBIOS = TRUE"));for(e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();if(a=c.fun.clear(b.releaseDate))d["PCB-BIOS-RELEASE"]=
c.lib.date2str(c.fun.wql2date(a,r.getTimezoneOffset()),"d.m.Y H:i:s");if(a=c.fun.clear(b.releaseDate))d["PCB-BIOS-RELEASE-DATE"]=c.lib.date2str(c.fun.wql2date(a,r.getTimezoneOffset()),"d.m.Y");if(a=c.fun.clear(b.manufacturer,"Inc."))d["PCB-BIOS-MANUFACTURE"]=a;if(a=c.fun.clear(b.smBIOSBIOSVersion))d["PCB-BIOS-VERSION"]=a;if(a=c.fun.clear(b.serialNumber))d["PCB-BIOS-SERIAL"]=a;break}g=null;response=t.execQuery(c.fun.debug("SELECT * FROM Win32_NetworkAdapterConfiguration WHERE ipEnabled = TRUE AND fullDNSRegistrationEnabled = TRUE"));
for(e=new Enumerator(response);!e.atEnd();)if(b=e.item(),e.moveNext(),!b.serviceName||-1==b.serviceName.indexOf("vpn"))if(!b.serviceName||-1==b.serviceName.indexOf("loop"))if(!b.serviceName||-1==b.serviceName.indexOf("VBox")){b.interfaceIndex&&(g=b);if(null!=b.ipAddress){f=b.ipAddress.toArray();h=0;for(var q=f.length;h<q;h++)(a=c.fun.clear(f[h]))&&-1!=a.indexOf(".")&&!d["NET-IP-V4"]&&(d["NET-IP-V4"]=a),a&&-1==a.indexOf(".")&&!d["NET-IP-V6"]&&(d["NET-IP-V6"]=a)}if(null!=b.defaultIPGateway)for(f=b.defaultIPGateway.toArray(),
h=0,q=f.length;h<q;h++)(a=c.fun.clear(f[h]))&&-1!=a.indexOf(".")&&!d["NET-GATEWAY-V4"]&&(d["NET-GATEWAY-V4"]=a),a&&-1==a.indexOf(".")&&!d["NET-GATEWAY-V6"]&&(d["NET-GATEWAY-V6"]=a);if(null!=b.dnsServerSearchOrder)for(f=b.dnsServerSearchOrder.toArray(),h=0,q=f.length;h<q;h++)(a=c.fun.clear(f[h]))&&-1!=a.indexOf(".")&&!d["NET-DNS-V4"]&&(d["NET-DNS-V4"]=a),a&&-1==a.indexOf(".")&&!d["NET-DNS-V6"]&&(d["NET-DNS-V6"]=a);if(null!=b.ipSubnet)for(f=b.ipSubnet.toArray(),h=0,q=f.length;h<q;h++)(a=c.fun.clear(f[h]))&&
-1!=a.indexOf(".")&&!d["NET-SUBNET-V4"]&&(d["NET-SUBNET-V4"]=a),a&&-1==a.indexOf(".")&&!d["NET-SUBNET-V6"]&&(d["NET-SUBNET-V6"]=a);if(a=c.fun.clear(b.dhcpServer))d["NET-DHCP-V4"]=a;if(a=c.fun.clear(b.description,"Сетевой адаптер","Адаптер","для виртуальной сети","Сетевая карта","Контроллер","NIC (NDIS 6.20)","- Минипорт планировщика пакетов","Family Controller","Adapter","Virtual Miniport","for Windows","x64").replace(/#\d+$/g,""))d["NET-NAME"]=a;if(a=c.fun.clear(b.macAddress))d["NET-MAC"]=a;break}if(g&&
g.interfaceIndex)for(response=t.execQuery(c.fun.debug("SELECT speed, timeOfLastReset FROM Win32_NetworkAdapter WHERE netEnabled = TRUE AND interfaceIndex = "+c.fun.repair(g.interfaceIndex))),e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();if(a=b.speed)d["NET-SPEED"]=c.fun.info2str(a,0,1E3)+"бит/с";if(a=b.speed)d["NET-SPEED-VAL"]=a;if(a=b.timeOfLastReset)d["NET-RESET"]=c.lib.date2str(c.fun.wql2date(a),"d.m.Y H:i:s");if(a=b.timeOfLastReset)d["NET-RESET-DATE"]=c.lib.date2str(c.fun.wql2date(a),
"d.m.Y");break}response=t.execQuery(c.fun.debug("SELECT * FROM Win32_ComputerSystem"));for(e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();if(a=b.dnsHostName)m=a;if(a=b.name)m||(m=a.toLowerCase());b.domain!=b.workgroup&&(p=b.domain);if(a=b.userName)l.domain=a.split(c.val.keyDelim)[0];if(a=b.userName)l.login=a.split(c.val.keyDelim)[1];if(a=b.userName)l.account=a;if(a=c.fun.clear(m))d["NET-HOST"]=a;if(a=c.fun.clear(b.domain))d["NET-DOMAIN"]=a;if(a=c.fun.clear(b.model))d["DEV-NAME"]=
a;a&&(a=c.fun.clear(b.manufacturer,"Inc.","Hewlett-Packard"))&&(d["DEV-NAME"]=a.split(" ")[0]+" "+c.fun.clear(b.model));break}!l.account&&v&&(f=[],e=v.methods_.item("getStringValue"),b=e.inParameters.spawnInstance_(),b.hDefKey=2147483650,b.sSubKeyName="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon",b.sValueName=c.fun.debug("DefaultDomainName"),b=v.execMethod_(e.name,b),!b.returnValue&&b.sValue&&f.push(b.sValue),e=v.methods_.item("getStringValue"),b=e.inParameters.spawnInstance_(),b.hDefKey=
2147483650,b.sSubKeyName="SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon",b.sValueName=c.fun.debug("DefaultUserName"),b=v.execMethod_(e.name,b),!b.returnValue&&b.sValue&&f.push(b.sValue),2==f.length&&(l.domain=f[0]),2==f.length&&(l.login=f[1]),2==f.length&&(l.account=f.join(c.val.keyDelim)));if(!l.account){f=null;response=t.execQuery(c.fun.debug("SELECT lastUseTime, localPath, loaded, sid FROM Win32_UserProfile WHERE special = FALSE"));for(e=new Enumerator(response);!e.atEnd();)b=e.item(),
e.moveNext(),(a=f?0:1)||(a=b.loaded&&!f.loaded?1:a),a||(a=c.lib.compare(c.fun.wql2date(b.lastUseTime),c.fun.wql2date(f.lastUseTime))),0<a&&(f=b);if(b=f)if(l.profile=b.localPath,a=b.sid)l.sid=a}if(!l.account&&l.sid){f=[];try{b=t.get('Win32_SID.SID="'+l.sid+'"')}catch(y){b=null}(a=b.referencedDomainName)&&f.push(a);(a=b.accountName)&&f.push(a);2==f.length&&(l.domain=f[0]);2==f.length&&(l.login=f[1]);2==f.length&&(l.account=f.join(c.val.keyDelim))}if(l.account&&c.lib.hasValue([".",m],l.domain,!1))for(response=
t.execQuery(c.fun.debug("SELECT domain, name, fullName, sid FROM Win32_UserAccount WHERE name = "+c.fun.repair(l.login)+" AND domain = "+c.fun.repair(l.domain))),e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();f=[];l.name=b.fullName;if(a=b.sid)l.sid=a;(a=b.domain)&&f.push(a);(a=b.name)&&f.push(a);2==f.length&&(l.domain=f[0]);2==f.length&&(l.login=f[1]);2==f.length&&(l.account=f.join(c.val.keyDelim));break}if(l.account&&u&&!c.lib.hasValue([".",m],l.domain,!1))for(f="DS_co DS_c DS_company DS_displayName DS_department DS_info DS_homeDirectory DS_l DS_mail DS_mobile DS_objectSid DS_telephoneNumber DS_title DS_distinguishedName".split(" "),
response=u.execQuery(c.fun.debug("SELECT "+f.join(", ")+" FROM DS_user WHERE DS_sAMAccountName = "+c.fun.repair(l.login))),e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();l.name=b.DS_displayName;l.home=b.DS_homeDirectory;if(f=b.DS_objectSid)if(a=c.fun.bin2sid(f.value))l.sid=a;if(a=c.fun.clear(b.DS_co))d["USR-COUNTRY"]=a;if(a=c.fun.clear(b.DS_c))d["USR-COUNTRY-ID"]=a;if(a=c.fun.clear(b.DS_company,'"'))d["USR-COMPANY"]=a;if(a=c.fun.clear(b.DS_department,'"'))d["USR-DEPARTMENT"]=a;if(a=
c.fun.clear(b.DS_distinguishedName))d["USR-ACCOUNT-DN"]=a;if(a=c.fun.clear(b.DS_l))d["USR-CITY"]=a;if(a=c.fun.clear(b.DS_mail))d["USR-EMAIL"]=a;if(a=c.fun.clear(b.DS_mobile))d["USR-MOBILE"]=a;if(a=c.fun.clear(b.DS_telephoneNumber))d["USR-PHONE"]=a;if(a=c.fun.clear(b.DS_title,'"'))d["USR-POSITION"]=a;if(a=c.fun.clear(b.DS_info,'"'))d["USR-INFO"]=a;break}if(l.account&&!("home"in l))for(response=t.execQuery(c.fun.debug("SELECT homeDirectory FROM Win32_NetworkLoginProfile WHERE name = "+c.fun.repair(l.account))),
e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();l.home=b.homeDirectory;break}if(l.sid&&!("profile"in l))for(response=t.execQuery(c.fun.debug("SELECT localPath FROM Win32_UserProfile WHERE sid = "+c.fun.repair(l.sid))),e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();l.profile=b.localPath;break}if(a=c.fun.clear(l.sid))d["USR-SID"]=a;if(a=c.fun.clear(l.account))d["USR-ACCOUNT"]=a;if(a=c.fun.clear(l.login))d["USR-LOGIN"]=a;if(a=c.fun.clear(l.domain))d["USR-DOMAIN"]=a;if(a=
c.fun.clear(l.profile))d["USR-PROFILE"]=a;if(a=c.fun.clear(l.home))d["USR-HOME"]=a;if(a=c.fun.clear(l.name))d["USR-NAME"]=a;if(a=c.fun.clear(l.name)){f=a.split(c.val.argDelim);for(h=f.length-1;-1<h;h--)a=c.fun.clear(f[h],/[\[\(,\.\)\]]/g),(k=(k=3>a.length)||c.lib.hasValue(["von"],a,!0))?f.splice(h,1):f[h]=a;if(a=f[0])d["USR-NAME-FIRST"]=a;if(a=f[1])d["USR-NAME-SECOND"]=a;if(a=f[2])d["USR-NAME-THIRD"]=a;if(a=f[3])d["USR-NAME-FOURTH"]=a}if(m&&u&&p)for(response=u.execQuery(c.fun.debug("SELECT DS_distinguishedName FROM DS_computer WHERE DS_cn = "+
c.fun.repair(m))),e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();if(a=c.fun.clear(b.DS_distinguishedName))d["NET-HOST-DN"]=a;break}u=0;response=t.execQuery(c.fun.debug("SELECT architecture, maxClockSpeed, name, revision, numberOfCores, socketDesignation FROM Win32_Processor WHERE role = 'CPU'"));for(e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();0==b.architecture?d["CPU-ARCHITECTURE"]="x86":9==b.architecture&&(d["CPU-ARCHITECTURE"]="x64");if(a=b.maxClockSpeed)d["CPU-SPEED"]=
c.fun.info2str(1E6*a,2,1E3)+"Гц";if(a=b.maxClockSpeed)d["CPU-SPEED-VAL"]=1E6*a;if(a=c.fun.clear(b.name,"CPU","APU","Процессор","Processor","with","Radeon HD Graphics","11th Gen"))d["CPU-NAME"]=a;if(a=c.fun.clear(b.revision))d["CPU-VERSION"]=a;if(a=c.fun.clear(b.numberOfCores))d["CPU-CORE"]=a;if(a=c.fun.clear(b.socketDesignation,"SOCKET 0"))d["CPU-SOCKET"]=a;if(a=b.maxClockSpeed)u+=2.26143*Math.sqrt(a/1E3);if(a=b.numberOfCores)u*=1.02033*Math.sqrt(a);break}u&&(w=w?Math.min(w,u):u);response=t.execQuery(c.fun.debug("SELECT level, maxCacheSize FROM Win32_CacheMemory"));
for(e=new Enumerator(response);!e.atEnd();)if(b=e.item(),e.moveNext(),a=b.maxCacheSize)d["CPU-CACHE-L"+(b.level-2)]=c.fun.info2str(1024*a,0)+"Б";k=u=0;response=t.execQuery(c.fun.debug("SELECT capacity, speed FROM Win32_PhysicalMemory"));for(e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();if(a=b.capacity)d["RAM-SIZE-VAL"]=k+=1*a;if(a=b.capacity)d["RAM-SIZE"]=c.fun.info2str(k,0)+"Б";if(a=b.speed)d["RAM-SPEED"]=a+" МГц";if(a=b.speed)d["RAM-SPEED-VAL"]=1E6*a;if(a=k)u=2.51143*Math.sqrt(a/
1024/1024/1024);if(a=b.speed)u*=.92245*Math.sqrt(a/1E3)}u&&(w=w?Math.min(w,u):u);g=f=null;response=t.execQuery(c.fun.debug("SELECT adapterRam, name, driverVersion, currentHorizontalResolution, currentRefreshRate, currentBitsPerPixel, currentVerticalResolution FROM Win32_VideoController"));for(e=new Enumerator(response);!e.atEnd();)b=e.item(),e.moveNext(),b.currentHorizontalResolution&&b.currentVerticalResolution&&(k="Microsoft Remote Display",(a=g?0:1)||(a=b.name&&-1!=b.name.indexOf(k)?1:a),a||(a=
g.name&&-1!=g.name.indexOf(k)?-1:a),a||(a=c.lib.compare(b.currentHorizontalResolution,g.currentHorizontalResolution)),a||(a=c.lib.compare(b.currentVerticalResolution,g.currentVerticalResolution)),0<a&&(g=b)),(a=f?0:1)||(a=c.lib.compare(Math.abs(b.adapterRam),Math.abs(f.adapterRam))),a||(a=c.lib.compare(b.currentHorizontalResolution,f.currentHorizontalResolution)),a||(a=c.lib.compare(b.currentVerticalResolution,f.currentVerticalResolution)),0<a&&(f=b);if(b=f){if(a=b.adapterRam)d["GPU-SIZE"]=c.fun.info2str(Math.abs(a),
0)+"Б";if(a=b.adapterRam)d["GPU-SIZE-VAL"]=Math.abs(a);if(a=c.fun.clear(b.name,"GPU","Видеоустройство","Family","Chipset","Series","Graphics","Adapter"))d["GPU-NAME"]=a;if(a=c.fun.clear(b.driverVersion))d["GPU-VERSION"]=a;if(a=g&&g.currentHorizontalResolution)d["GPU-RESOLUTION-X"]=a;if(a=g&&g.currentVerticalResolution)d["GPU-RESOLUTION-Y"]=a;if(a=g&&g.currentRefreshRate)d["GPU-FREQUENCY"]=c.fun.info2str(a,0,1E3)+"Гц";if(a=g&&g.currentRefreshRate)d["GPU-FREQUENCY-VAL"]=a;if(a=g&&g.currentBitsPerPixel)d["GPU-COLOR"]=
c.fun.info2str(a,0)+"бит"+c.lib.numDeclin(a,"","","а");if(a=g&&g.currentBitsPerPixel)d["GPU-COLOR-VAL"]=a;g&&g.currentHorizontalResolution&&g.currentVerticalResolution&&(d["GPU-RESOLUTION"]=g.currentHorizontalResolution+" x "+g.currentVerticalResolution)}if(z){g=null;response=z.execQuery(c.fun.debug("SELECT instanceName, serialNumberId, userFriendlyName, userFriendlyNameLength, weekOfManufacture, yearOfManufacture FROM WmiMonitorID WHERE active = TRUE"));for(e=new Enumerator(response);!e.atEnd();)if(b=
e.item(),e.moveNext(),b.userFriendlyNameLength){b.instanceName&&(g=b);if(a=c.fun.bin2str(b.userFriendlyName))if(a=c.fun.clear(a," 4K"," HDR"))d["MON-NAME"]=a;(a=c.fun.bin2str(b.serialNumberId))&&(a=c.fun.clear(a))&&"0"!=a&&(d["MON-SERIAL"]=a);b.yearOfManufacture&&b.weekOfManufacture&&(d["MON-RELEASE"]=c.lib.date2str(c.fun.getDateOfWeek(b.weekOfManufacture,b.yearOfManufacture),"d.m.Y H:i:s"));b.yearOfManufacture&&b.weekOfManufacture&&(d["MON-RELEASE-DATE"]=c.lib.date2str(c.fun.getDateOfWeek(b.weekOfManufacture,
b.yearOfManufacture),"d.m.Y"));break}if(g&&g.instanceName)for(response=z.execQuery(c.fun.debug("SELECT maxHorizontalImageSize, maxVerticalImageSize FROM WmiMonitorBasicDisplayParams WHERE instanceName = "+c.fun.repair(g.instanceName))),e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();if(a=b.maxHorizontalImageSize)d["MON-SIZE-X"]=a;if(a=b.maxVerticalImageSize)d["MON-SIZE-Y"]=a;b.maxHorizontalImageSize&&b.maxVerticalImageSize&&(a=Math.sqrt(Math.pow(b.maxHorizontalImageSize,2)+Math.pow(b.maxVerticalImageSize,
2)),a=Math.round(a/2.54),d["MON-SIZE"]=b.maxHorizontalImageSize+" x "+b.maxVerticalImageSize+" см / "+a+" дюйм"+c.lib.numDeclin(a,"ов","","а"),d["MON-SIZE-Z"]=a);break}}u=0;response=C?C.execQuery(c.fun.debug("SELECT model, firmwareVersion, mediaType, serialNumber, size FROM MSFT_PhysicalDisk")):t.execQuery(c.fun.debug("SELECT * FROM Win32_DiskDrive"));for(e=new Enumerator(response);!e.atEnd();){b=e.item();e.moveNext();switch(b.mediaType){case 0:k="USB";break;case 3:k="HDD";break;case 4:k="SSD";break;
case 5:k="SCM";break;case "Removable Media":k="USB";break;case "Fixed\thard disk media":case "Fixed hard disk media":k=b.model&&-1!=b.model.indexOf("Solid")?"SSD":b.model&&-1!=b.model.indexOf("SSD")?"SSD":b.model&&!b.model.indexOf("ADATA")?"SSD":"HDD";break;default:k=""}if((!b.model||-1==b.model.indexOf("Raid"))&&k&&!d[k+"-NAME"]){if(a=c.fun.clear(b.model,"ATA Device","SCSI Disk Device","USB Device","SSD","SATA"))d[k+"-NAME"]=a;if(a=c.fun.clear(b.firmwareVersion||b.firmwareRevision))d[k+"-VERSION"]=
a;if(a=c.fun.clear(b.serialNumber))d[k+"-SERIAL"]=a;if(a=b.size)d[k+"-SIZE"]=c.fun.info2str(a,0)+"Б";if(a=b.size)d[k+"-SIZE-VAL"]=a;k&&(u=Math.max(u,"SDD"==k?15.51143:7.14577))}}u&&(w=w?Math.min(w,u):u);response=t.execQuery(c.fun.debug("SELECT mediaType, caption, drive FROM Win32_CDROMDrive"));for(e=new Enumerator(response);!e.atEnd();)if(b=e.item(),e.moveNext(),!b.caption||-1==b.caption.indexOf("Alcohol"))if(!b.caption||-1==b.caption.indexOf("Virtual"))if(!b.caption||-1==b.caption.indexOf("Виртуальный"))if(!b.mediaType||
"UNKNOWN"!=b.mediaType){switch(b.mediaType){case "CD-ROM":d["ROM-TYPE"]="CD";break;case "DVD-ROM":d["ROM-TYPE"]="DVD";break;case "CD Writer":d["ROM-TYPE"]="CD-RW";break;case "DVD Writer":d["ROM-TYPE"]="DVD-RW"}if(a=c.fun.clear(b.caption,"ATA Device","SCSI CdRom Device"))d["ROM-NAME"]=a;if(a=c.fun.clear(b.drive))d["ROM-DRIVE"]=a;break}g=null;k="DisplayIcon";f=["SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\F3 TAIL","SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\F3 TAIL",
"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\еФарма","SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\еФарма"];a="";if(v)for(e=v.methods_.item("getStringValue"),h=0,q=f.length;h<q&&!a;h++)b=e.inParameters.spawnInstance_(),b.hDefKey=2147483650,b.sSubKeyName=c.fun.debug(f[h]),b.sValueName=k,b=v.execMethod_(e.name,b),!b.returnValue&&b.sValue&&(a=c.fun.clear(b.sValue));a&&(f=a.split(c.val.keyDelim),f.pop(),f.pop(),g=f.join(c.val.keyDelim),d["APP-EFARMA-DIR"]=g);k="\\Client\\ePlus.Client.exe";
f=g?[g]:[];a="";h=0;for(q=f.length;h<q;h++)h&&(a+=" OR "),a+="name = "+c.fun.repair(f[h]+k);if(a)for(response=t.execQuery(c.fun.debug("SELECT name FROM CIM_DataFile WHERE "+a)),e=new Enumerator(response);!e.atEnd();)for(b=e.item(),e.moveNext(),h=0,q=f.length;h<q;h++)if(a=f[h]+k,b.name&&b.name.toLowerCase()==a.toLowerCase()){d["APP-EFARMA-CLIENT"]=a;break}k="\\ARM\\ePlus.ARMCasherNew.exe";f=g?[g]:[];a="";h=0;for(q=f.length;h<q;h++)h&&(a+=" OR "),a+="name = "+c.fun.repair(f[h]+k);if(a)for(response=
t.execQuery(c.fun.debug("SELECT name FROM CIM_DataFile WHERE "+a)),e=new Enumerator(response);!e.atEnd();)for(b=e.item(),e.moveNext(),h=0,q=f.length;h<q;h++)if(a=f[h]+k,b.name&&b.name.toLowerCase()==a.toLowerCase()){d["APP-EFARMA-CASHER"]=a;break}k="\\UpdateServer\\ePlus.UpdateServer.exe";f=g?[g]:[];a="";h=0;for(q=f.length;h<q;h++)h&&(a+=" OR "),a+="name = "+c.fun.repair(f[h]+k);if(a)for(response=t.execQuery(c.fun.debug("SELECT name FROM CIM_DataFile WHERE "+a)),e=new Enumerator(response);!e.atEnd();)for(b=
e.item(),e.moveNext(),h=0,q=f.length;h<q;h++)if(a=f[h]+k,b.name&&b.name.toLowerCase()==a.toLowerCase()){d["APP-EFARMA-UPDATER"]=a;break}k="lic";f=g?[g+"\\UpdateServer\\",g+"\\Client\\",g+"\\ARM\\"]:[];a="";h=0;for(q=f.length;h<q;h++)h&&(a+=" OR "),a+="drive = "+c.fun.repair(c.lib.strim(f[h],"",":",!0,!1))+" ",a+="AND path = "+c.fun.repair(c.lib.strim(f[h],":","",!1,!1))+" ",a+="AND extension = "+c.fun.repair(k);if(a)for(response=t.execQuery(c.fun.debug("SELECT name, fileName FROM CIM_DataFile WHERE "+
a)),e=new Enumerator(response);!e.atEnd();)for(b=e.item(),e.moveNext(),h=0,q=f.length;h<q;h++)if(a=f[h]+b.fileName+"."+k,b.name&&b.name.toLowerCase()==a.toLowerCase()){d["APP-EFARMA-LICENSE"]=a;break}a=c.lib.date2str(r,"Y");k="\\ULUS.exe";f=["C:\\SoftLink\\Ulus\\"+a,"C:\\LO\\ULUS\\"+a,"C:\\so\\Ulus\\"+a,"C:\\ULUS\\"+a];a="";h=0;for(q=f.length;h<q;h++)h&&(a+=" OR "),a+="name = "+c.fun.repair(f[h]+k);if(a)for(response=t.execQuery(c.fun.debug("SELECT name FROM CIM_DataFile WHERE "+a)),e=new Enumerator(response);!e.atEnd();)for(b=
e.item(),e.moveNext(),h=0,q=f.length;h<q;h++)if(a=f[h]+k,b.name&&b.name.toLowerCase()==a.toLowerCase()){d["APP-ULUS"]=a;d["APP-ULUS-DIR"]=f[h];break}k="";f=["SOFTWARE\\Clients\\StartMenuInternet\\Google Chrome\\shell\\open\\command","SOFTWARE\\WOW6432Node\\Clients\\StartMenuInternet\\Google Chrome\\shell\\open\\command"];a="";if(v)for(e=v.methods_.item("getStringValue"),h=0,q=f.length;h<q&&!a;h++)b=e.inParameters.spawnInstance_(),b.hDefKey=2147483650,b.sSubKeyName=c.fun.debug(f[h]),b.sValueName=k,
b=v.execMethod_(e.name,b),!b.returnValue&&b.sValue&&(a=c.fun.clear(b.sValue));a&&(f=a.split(c.val.keyDelim),f.pop(),d["APP-CHROME"]=a,d["APP-CHROME-DIR"]=f.join(c.val.keyDelim));k="";f=["SOFTWARE\\VideoLAN\\VLC","SOFTWARE\\WOW6432Node\\VideoLAN\\VLC"];a="";if(v)for(e=v.methods_.item("getStringValue"),h=0,q=f.length;h<q&&!a;h++)b=e.inParameters.spawnInstance_(),b.hDefKey=2147483650,b.sSubKeyName=c.fun.debug(f[h]),b.sValueName=k,b=v.execMethod_(e.name,b),!b.returnValue&&b.sValue&&(a=c.fun.clear(b.sValue));
a&&(f=a.split(c.val.keyDelim),f.pop(),d["APP-VLC"]=a,d["APP-VLC-DIR"]=f.join(c.val.keyDelim));k="ClientID";f=["SOFTWARE\\TeamViewer","SOFTWARE\\WOW6432Node\\TeamViewer"];a="";if(v)for(e=v.methods_.item("getDWORDValue"),h=0,q=f.length;h<q&&!a;h++)b=e.inParameters.spawnInstance_(),b.hDefKey=2147483650,b.sSubKeyName=c.fun.debug(f[h]),b.sValueName=k,b=v.execMethod_(e.name,b),!b.returnValue&&b.uValue&&(a=c.fun.clear(b.uValue));a&&(d["APP-TEAMVIEWER-ID"]=a);f=[];d["CPU-NAME"]&&d["CPU-CORE"]&&d["CPU-SPEED"]&&
f.push(c.fun.clear(d["CPU-NAME"].replace("Dual-Core","Intel"),"Dual Core","Xeon","Pentium","Celeron","Core2 Duo","Core","Processor","Athlon 64","Athlon",/,.+/,/@.+/,/\d\.d+GHz/)+" "+d["CPU-CORE"]+"x"+d["CPU-SPEED"].replace(",",".").replace(" МГц","M").replace(" ГГц","G")+"Hz");d["RAM-SIZE"]&&d["RAM-SPEED"]&&f.push(d["RAM-SIZE"].replace(" МБ","MB").replace(" ГБ","GB")+" "+d["RAM-SPEED"].replace(" МГц","M").replace(" ГГц","G")+"Hz");d["GPU-SIZE"]&&d["GPU-NAME"]&&(-1!=d["GPU-NAME"].indexOf("GeForce")||
-1!=d["GPU-NAME"].indexOf("Radeon"))&&f.push(d["GPU-SIZE"].replace(" МБ","MB").replace(" ГБ","GB")+" "+c.fun.clear(d["GPU-NAME"],"AMD","NVIDIA","GeForce","Radeon",/\(.+/));d["HDD-SIZE"]&&f.push(d["HDD-SIZE"].replace(" МБ","MB").replace(" ГБ","GB").replace(" ТБ","TB")+" HDD");d["SSD-SIZE"]&&f.push(d["SSD-SIZE"].replace(" МБ","MB").replace(" ГБ","GB").replace(" ТБ","TB")+" SSD");d["USB-SIZE"]&&f.push(d["USB-SIZE"].replace(" МБ","MB").replace(" ГБ","GB").replace(" ТБ","TB")+" USB");d["ROM-TYPE"]&&f.push(d["ROM-TYPE"]);
f.length&&(d["DEV-DESCRIPTION"]=f.join("/"));w&&(d["DEV-BENCHMARK"]=c.lib.num2str(w,5,",",""))}var D="NET-HOST NET-DOMAIN SYS-NAME SYS-VERSION SYS-ARCHITECTURE SYS-KEY SYS-TIME SYS-DRIVE SYS-INSTALL SYS-RESET PCB-NAME PCB-SERIAL PCB-BIOS-SERIAL PCB-BIOS-RELEASE CPU-NAME CPU-SOCKET CPU-CORE CPU-SPEED CPU-SPEED-VAL RAM-SPEED RAM-SIZE RAM-SIZE-VAL GPU-NAME GPU-RESOLUTION GPU-SIZE GPU-SIZE-VAL MON-NAME MON-SERIAL MON-SIZE MON-SIZE-Z MON-RELEASE NET-NAME NET-MAC NET-IP-V4 NET-SUBNET-V4 NET-GATEWAY-V4 NET-DNS-V4 NET-DHCP-V4 NET-IP-V6 NET-SUBNET-V6 NET-GATEWAY-V6 NET-SPEED NET-SPEED-VAL NET-RESET SSD-NAME SSD-SERIAL SSD-SIZE SSD-SIZE-VAL HDD-NAME HDD-SERIAL HDD-SIZE HDD-SIZE-VAL USB-NAME USB-SERIAL USB-SIZE USB-SIZE-VAL ROM-NAME ROM-TYPE ROM-DRIVE USR-ACCOUNT USR-DOMAIN USR-LOGIN USR-NAME USR-SID USR-COUNTRY USR-CITY USR-COMPANY USR-DEPARTMENT USR-POSITION USR-EMAIL USR-PHONE USR-MOBILE USR-PROFILE DEV-NAME DEV-DESCRIPTION DEV-BENCHMARK".split(" ");
if(n.input){c.fun.debug("Read input data");try{k="windows-1251",a=x.stdIn.readAll(),n.charset!=k&&(a=c.wsh.iconv(n.charset,k,a))}catch(y){a=""}}e=null;if(n.input&&a)switch(r="",c.fun.debug("Convert input data"),n.input){case "TSV":r||(r=c.val.tsvDelim);case "CSV":r||(r=c.val.csvDelim),e||(e=c.lib.tsv2arr(a,!1,r)),e.length&&(D=e.shift());case "tsv":r||(r=c.val.tsvDelim);case "csv":for(r||(r=c.val.csvDelim),e||(e=c.lib.tsv2arr(a,!1,r)),h=0,q=e.length;h<q;h++)b=e[h],b=c.lib.arr2obj(b,null,function(y,
E){if(y)return D[E]}),e[h]=b;case "ini":e||(e=[c.lib.ini2obj(a,!1)]);f={};h=0;for(q=e.length;h<q;h++){b=e[h];for(k in b)(a=b[k])&&(f[k]=a);for(k in d)a=d[k],b[k]=a;e[h]=b}for(k in f)a=f[k],!k||!a||k in d||(d[k]=a)}if(n.output)switch(r="",e=e||[d],t=null,c.fun.debug("Convert output data"),n.output){case "ini":r=c.val.argDelim+c.val.iniDelim+c.val.argDelim;b=c.lib.sort(d,"asc");a=c.lib.obj2str(b,!1,c.val.linDelim,r);break;case "TSV":r||(r=c.val.tsvDelim);case "CSV":r||(r=c.val.csvDelim),t=!1;case "tsv":r||
(r=c.val.tsvDelim);case "csv":r||(r=c.val.csvDelim),a=c.lib.arr2tsv(e,D,r,t)}if(n.output&&a){a+=c.val.linDelim;c.fun.debug("Write output data");try{x.stdOut.write(a)}catch(y){}}c.fun.debug("Set environment variables");e=A.environment(c.val.envType);for(k in d)a=d[k],setEnv(e,k,a);e=[];h=x.arguments.length;for(g=B;g<h;g++)a=x.arguments.item(g),a=a.split(c.val.getDelim).join(c.val.setDelim),(a=A.expandEnvironmentStrings(a))&&-1==a.indexOf(c.val.argDelim)||(a=c.val.argWrap+a+c.val.argWrap),e.push(a);
if(d=e.join(c.val.argDelim)){B=n.silent?0:c.val.runStyle;c.fun.debug("Calling an external command");try{a=A.run(d,B,!n.nowait),n.nowait&&(a=c.val.defReturn)}catch(y){a=c.val.defReturn}}else a=c.val.defReturn;c.fun.debug("Exit with code "+a);c.fun.debug(n.debug);x.quit(a)}})})(WSH,env);env.init();
